!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.AirDatepicker=t():e.AirDatepicker=t()}(this,(function(){return function(){"use strict";var e={d:function(t,i){for(var s in i)e.o(i,s)&&!e.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:i[s]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}},t={};e.d(t,{default:function(){return B}});var i={days:"days",months:"months",years:"years",day:"day",month:"month",year:"year",eventChangeViewDate:"changeViewDate",eventChangeCurrentView:"changeCurrentView",eventChangeFocusDate:"changeFocusDate",eventChangeSelectedDate:"changeSelectedDate",eventChangeTime:"changeTime",eventChangeLastSelectedDate:"changeLastSelectedDate",actionSelectDate:"selectDate",actionUnselectDate:"unselectDate",cssClassWeekend:"-weekend-"},s={classes:"",inline:!1,locale:{days:["Воскресенье","Понедельник","Вторник","Среда","Четверг","Пятница","Суббота"],daysShort:["Вос","Пон","Вто","Сре","Чет","Пят","Суб"],daysMin:["Вс","Пн","Вт","Ср","Чт","Пт","Сб"],months:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],monthsShort:["Янв","Фев","Мар","Апр","Май","Июн","Июл","Авг","Сен","Окт","Ноя","Дек"],today:"Сегодня",clear:"Очистить",dateFormat:"dd.MM.yyyy",timeFormat:"HH:mm",firstDay:1},startDate:new Date,firstDay:"",weekends:[6,0],dateFormat:"",altField:"",altFieldDateFormat:"T",toggleSelected:!0,keyboardNav:!0,selectedDates:!1,container:"",isMobile:!1,visible:!1,position:"bottom left",offset:12,view:i.days,minView:i.days,showOtherMonths:!0,selectOtherMonths:!0,moveToOtherMonthsOnSelect:!0,showOtherYears:!0,selectOtherYears:!0,moveToOtherYearsOnSelect:!0,minDate:"",maxDate:"",disableNavWhenOutOfRange:!0,multipleDates:!1,multipleDatesSeparator:", ",range:!1,dynamicRange:!0,buttons:!1,monthsField:"monthsShort",showEvent:"focus",autoClose:!1,prevHtml:'<svg><path d="M 17,12 l -5,5 l 5,5"></path></svg>',nextHtml:'<svg><path d="M 14,12 l 5,5 l -5,5"></path></svg>',navTitles:{days:"MMMM, <i>yyyy</i>",months:"yyyy",years:"yyyy1 - yyyy2"},timepicker:!1,onlyTimepicker:!1,dateTimeSeparator:" ",timeFormat:"",minHours:0,maxHours:24,minMinutes:0,maxMinutes:59,hoursStep:1,minutesStep:1,onSelect:!1,onChangeViewDate:!1,onChangeView:!1,onRenderCell:!1,onShow:!1,onHide:!1,onClickDayName:!1};function a(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document;return"string"==typeof e?t.querySelector(e):e}function n(){let{tagName:e="div",className:t="",innerHtml:i="",id:s="",attrs:a={}}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=document.createElement(e);return t&&n.classList.add(...t.split(" ")),s&&(n.id=s),i&&(n.innerHTML=i),a&&r(n,a),n}function r(e,t){for(let[i,s]of Object.entries(t))void 0!==s&&e.setAttribute(i,s);return e}function h(e){return new Date(e.getFullYear(),e.getMonth()+1,0).getDate()}function o(e){let t=e.getHours(),{hours:i,dayPeriod:s}=l(t);return{year:e.getFullYear(),month:e.getMonth(),fullMonth:e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1,date:e.getDate(),fullDate:e.getDate()<10?"0"+e.getDate():e.getDate(),day:e.getDay(),hours:t,fullHours:d(t),hours12:i,dayPeriod:s,fullHours12:d(i),minutes:e.getMinutes(),fullMinutes:e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes()}}function l(e){return{dayPeriod:e>11?"pm":"am",hours:e%12==0?12:e%12}}function d(e){return e<10?"0"+e:e}function c(e){let t=10*Math.floor(e.getFullYear()/10);return[t,t+9]}function u(){let e=[];for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];return i.forEach((t=>{if("object"==typeof t)for(let i in t)t[i]&&e.push(i);else t&&e.push(t)})),e.join(" ")}function p(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i.days;if(!e||!t)return!1;let a=o(e),n=o(t);return{[i.days]:a.date===n.date&&a.month===n.month&&a.year===n.year,[i.months]:a.month===n.month&&a.year===n.year,[i.years]:a.year===n.year}[s]}function m(e,t,i){let s=g(e,!1).getTime(),a=g(t,!1).getTime();return i?s>=a:s>a}function v(e,t){return!m(e,t,!0)}function g(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=new Date(e.getTime());return"boolean"!=typeof t||t||function(e){e.setHours(0,0,0,0)}(i),i}function D(e,t,i){e.length?e.forEach((e=>{e.addEventListener(t,i)})):e.addEventListener(t,i)}function y(e,t){return!(!e||e===document||e instanceof DocumentFragment)&&(e.matches(t)?e:y(e.parentNode,t))}function f(e,t,i){return e>i?i:e<t?t:e}function w(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),s=1;s<t;s++)i[s-1]=arguments[s];return i.filter((e=>e)).forEach((t=>{for(let[i,s]of Object.entries(t))if(void 0!==s&&"[object Object]"===s.toString()){let t=void 0!==e[i]?e[i].toString():void 0,a=s.toString(),n=Array.isArray(s)?[]:{};e[i]=e[i]?t!==a?n:e[i]:n,w(e[i],s)}else e[i]=s})),e}function b(e){let t=e;return e instanceof Date||(t=new Date(e)),isNaN(t.getTime())&&(console.log(`Unable to convert value "${e}" to Date object`),t=!1),t}function k(e){let t="\\s|\\.|-|/|\\\\|,|\\$|\\!|\\?|:|;";return new RegExp("(^|>|"+t+")("+e+")($|<|"+t+")","g")}function $(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var s=i.call(e,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class C{constructor(){let{type:e,date:t,dp:i,opts:s,body:a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};$(this,"focus",(()=>{this.$cell.classList.add("-focus-"),this.focused=!0})),$(this,"removeFocus",(()=>{this.$cell.classList.remove("-focus-"),this.focused=!1})),$(this,"select",(()=>{this.$cell.classList.add("-selected-"),this.selected=!0})),$(this,"removeSelect",(()=>{this.$cell.classList.remove("-selected-","-range-from-","-range-to-"),this.selected=!1})),$(this,"onChangeSelectedDate",(()=>{this.isDisabled||(this._handleSelectedStatus(),this.opts.range&&this._handleRangeStatus())})),$(this,"onChangeFocusDate",(e=>{if(!e)return void(this.focused&&this.removeFocus());let t=p(e,this.date,this.type);t?this.focus():!t&&this.focused&&this.removeFocus(),this.opts.range&&this._handleRangeStatus()})),$(this,"render",(()=>(this.$cell.innerHTML=this._getHtml(),this.$cell.adpCell=this,this.$cell))),this.type=e,this.singleType=this.type.slice(0,-1),this.date=t,this.dp=i,this.opts=s,this.body=a,this.customData=!1,this.init()}init(){let{range:e,onRenderCell:t}=this.opts;t&&(this.customData=t({date:this.date,cellType:this.singleType,datepicker:this.dp})),this._createElement(),this._bindDatepickerEvents(),this._handleInitialFocusStatus(),this.dp.hasSelectedDates&&(this._handleSelectedStatus(),e&&this._handleRangeStatus())}_bindDatepickerEvents(){this.dp.on(i.eventChangeSelectedDate,this.onChangeSelectedDate),this.dp.on(i.eventChangeFocusDate,this.onChangeFocusDate)}unbindDatepickerEvents(){this.dp.off(i.eventChangeSelectedDate,this.onChangeSelectedDate),this.dp.off(i.eventChangeFocusDate,this.onChangeFocusDate)}_createElement(){var e;let{year:t,month:i,date:s}=o(this.date),a=(null===(e=this.customData)||void 0===e?void 0:e.attrs)||{};this.$cell=n({className:this._getClassName(),attrs:{"data-year":t,"data-month":i,"data-date":s,...a}})}_getClassName(){var e,t;let s=new Date,{selectOtherMonths:a,selectOtherYears:n}=this.opts,{minDate:r,maxDate:h}=this.dp,{day:l}=o(this.date),d=this._isOutOfMinMaxRange(),c=null===(e=this.customData)||void 0===e?void 0:e.disabled,m=u("air-datepicker-cell",`-${this.singleType}-`,{"-current-":p(s,this.date,this.type),"-min-date-":r&&p(r,this.date,this.type),"-max-date-":h&&p(h,this.date,this.type)}),v="";switch(this.type){case i.days:v=u({"-weekend-":this.dp.isWeekend(l),"-other-month-":this.isOtherMonth,"-disabled-":this.isOtherMonth&&!a||d||c});break;case i.months:v=u({"-disabled-":d||c});break;case i.years:v=u({"-other-decade-":this.isOtherDecade,"-disabled-":d||this.isOtherDecade&&!n||c})}return u(m,v,null===(t=this.customData)||void 0===t?void 0:t.classes)}_getHtml(){var e;let{year:t,month:s,date:a}=o(this.date),{showOtherMonths:n,showOtherYears:r}=this.opts;if(null!==(e=this.customData)&&void 0!==e&&e.html)return this.customData.html;switch(this.type){case i.days:return!n&&this.isOtherMonth?"":a;case i.months:return this.dp.locale[this.opts.monthsField][s];case i.years:return!r&&this.isOtherDecade?"":t}}_isOutOfMinMaxRange(){let{minDate:e,maxDate:t}=this.dp,{type:s,date:a}=this,{month:n,year:r,date:h}=o(a),l=s===i.days,d=s===i.years,c=!!e&&new Date(r,d?e.getMonth():n,l?h:e.getDate()),u=!!t&&new Date(r,d?t.getMonth():n,l?h:t.getDate());return e&&t?v(c,e)||m(u,t):e?v(c,e):t?m(u,t):void 0}destroy(){this.unbindDatepickerEvents()}_handleRangeStatus(){let{rangeDateFrom:e,rangeDateTo:t}=this.dp,i=u({"-in-range-":e&&t&&(s=this.date,a=e,n=t,m(s,a)&&v(s,n)),"-range-from-":e&&p(this.date,e,this.type),"-range-to-":t&&p(this.date,t,this.type)});var s,a,n;this.$cell.classList.remove("-range-from-","-range-to-","-in-range-"),i&&this.$cell.classList.add(...i.split(" "))}_handleSelectedStatus(){let e=this.dp._checkIfDateIsSelected(this.date,this.type);e?this.select():!e&&this.selected&&this.removeSelect()}_handleInitialFocusStatus(){p(this.dp.focusDate,this.date,this.type)&&this.focus()}get isDisabled(){return this.$cell.matches(".-disabled-")}get isOtherMonth(){return this.dp.isOtherMonth(this.date)}get isOtherDecade(){return this.dp.isOtherDecade(this.date)}}function _(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var s=i.call(e,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}let M={[i.days]:`<div class="air-datepicker-body--day-names"></div><div class="air-datepicker-body--cells -${i.days}-"></div>`,[i.months]:`<div class="air-datepicker-body--cells -${i.months}-"></div>`,[i.years]:`<div class="air-datepicker-body--cells -${i.years}-"></div>`};const S=".air-datepicker-cell";class T{constructor(e){let{dp:t,type:s,opts:a}=e;_(this,"handleClick",(e=>{let t=e.target.closest(S).adpCell;if(t.isDisabled)return;if(!this.dp.isMinViewReached)return void this.dp.down();let i=this.dp._checkIfDateIsSelected(t.date,t.type);i?this.dp._handleAlreadySelectedDates(i,t.date):this.dp.selectDate(t.date)})),_(this,"handleDayNameClick",(e=>{let t=e.target.getAttribute("data-day-index");this.opts.onClickDayName({dayIndex:Number(t),datepicker:this.dp})})),_(this,"onChangeCurrentView",(e=>{e!==this.type?this.hide():(this.show(),this.render())})),_(this,"onMouseOverCell",(e=>{let t=y(e.target,S);this.dp.setFocusDate(!!t&&t.adpCell.date)})),_(this,"onMouseOutCell",(()=>{this.dp.setFocusDate(!1)})),_(this,"onClickBody",(e=>{let{onClickDayName:t}=this.opts,i=e.target;i.closest(S)&&this.handleClick(e),t&&i.closest(".air-datepicker-body--day-name")&&this.handleDayNameClick(e)})),_(this,"onMouseDown",(e=>{this.pressed=!0;let t=y(e.target,S),i=t&&t.adpCell;p(i.date,this.dp.rangeDateFrom)&&(this.rangeFromFocused=!0),p(i.date,this.dp.rangeDateTo)&&(this.rangeToFocused=!0)})),_(this,"onMouseMove",(e=>{if(!this.pressed||!this.dp.isMinViewReached)return;e.preventDefault();let t=y(e.target,S),i=t&&t.adpCell,{selectedDates:s,rangeDateTo:a,rangeDateFrom:n}=this.dp;if(!i||i.isDisabled)return;let{date:r}=i;if(2===s.length){if(this.rangeFromFocused&&!m(r,a)){let{hours:e,minutes:t}=o(n);r.setHours(e),r.setMinutes(t),this.dp.rangeDateFrom=r,this.dp.replaceDate(n,r)}if(this.rangeToFocused&&!v(r,n)){let{hours:e,minutes:t}=o(a);r.setHours(e),r.setMinutes(t),this.dp.rangeDateTo=r,this.dp.replaceDate(a,r)}}})),_(this,"onMouseUp",(()=>{this.pressed=!1,this.rangeFromFocused=!1,this.rangeToFocused=!1})),_(this,"onChangeViewDate",((e,t)=>{if(!this.isVisible)return;let s=c(e),a=c(t);switch(this.dp.currentView){case i.days:if(p(e,t,i.months))return;break;case i.months:if(p(e,t,i.years))return;break;case i.years:if(s[0]===a[0]&&s[1]===a[1])return}this.render()})),_(this,"render",(()=>{this.destroyCells(),this._generateCells(),this.cells.forEach((e=>{this.$cells.appendChild(e.render())}))})),this.dp=t,this.type=s,this.opts=a,this.cells=[],this.$el="",this.pressed=!1,this.isVisible=!0,this.init()}init(){this._buildBaseHtml(),this.type===i.days&&this.renderDayNames(),this.render(),this._bindEvents(),this._bindDatepickerEvents()}_bindEvents(){let{range:e,dynamicRange:t}=this.opts;D(this.$el,"mouseover",this.onMouseOverCell),D(this.$el,"mouseout",this.onMouseOutCell),D(this.$el,"click",this.onClickBody),e&&t&&(D(this.$el,"mousedown",this.onMouseDown),D(this.$el,"mousemove",this.onMouseMove),D(window.document,"mouseup",this.onMouseUp))}_bindDatepickerEvents(){this.dp.on(i.eventChangeViewDate,this.onChangeViewDate),this.dp.on(i.eventChangeCurrentView,this.onChangeCurrentView)}_buildBaseHtml(){this.$el=n({className:`air-datepicker-body -${this.type}-`,innerHtml:M[this.type]}),this.$names=a(".air-datepicker-body--day-names",this.$el),this.$cells=a(".air-datepicker-body--cells",this.$el)}_getDayNamesHtml(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.dp.locale.firstDay,t="",s=this.dp.isWeekend,{onClickDayName:a}=this.opts,n=e,r=0;for(;r<7;){let e=n%7;t+=`<div class="${u("air-datepicker-body--day-name",{[i.cssClassWeekend]:s(e),"-clickable-":!!a})}" data-day-index='${e}'>${this.dp.locale.daysMin[e]}</div>`,r++,n++}return t}renderDayNames(){this.$names.innerHTML=this._getDayNamesHtml()}_generateCell(e){let{type:t,dp:i,opts:s}=this;return new C({type:t,dp:i,opts:s,date:e,body:this})}_generateCells(){T.getDatesFunction(this.type)(this.dp,(e=>{this.cells.push(this._generateCell(e))}))}show(){this.isVisible=!0,this.$el.classList.remove("-hidden-")}hide(){this.isVisible=!1,this.$el.classList.add("-hidden-")}destroyCells(){this.cells.forEach((e=>e.destroy())),this.cells=[],this.$cells.innerHTML=""}destroy(){this.destroyCells(),this.dp.off(i.eventChangeViewDate,this.onChangeViewDate),this.dp.off(i.eventChangeCurrentView,this.onChangeCurrentView)}static getDaysDates(e,t){let{viewDate:i,locale:{firstDay:s}}=e,a=h(i),{year:n,month:r}=o(i),l=new Date(n,r,1),d=new Date(n,r,a),c=l.getDay()-s,u=6-d.getDay()+s;c=c<0?c+7:c,u=u>6?u-7:u;let p=function(e,t){let{year:i,month:s,date:a}=o(e);return new Date(i,s,a-t)}(l,c),m=a+c+u,v=p.getDate(),{year:g,month:D}=o(p),y=0;const f=[];for(;y<m;){let e=new Date(g,D,v+y);t&&t(e),f.push(e),y++}return f}static getMonthsDates(e,t){let{year:i}=e.parsedViewDate,s=0,a=[];for(;s<12;){const e=new Date(i,s);a.push(e),t&&t(e),s++}return a}static getYearsDates(e,t){let i=c(e.viewDate),s=i[0]-1,a=i[1]+1,n=s,r=[];for(;n<=a;){const e=new Date(n,0);r.push(e),t&&t(e),n++}return r}static getDatesFunction(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i.days;return{[i.days]:T.getDaysDates,[i.months]:T.getMonthsDates,[i.years]:T.getYearsDates}[e]}}function F(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var s=i.call(e,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class V{constructor(e){let{dp:t,opts:i}=e;F(this,"onClickNav",(e=>{let t=y(e.target,".air-datepicker-nav--action");if(!t)return;let i=t.dataset.action;this.dp[i]()})),F(this,"onChangeViewDate",(()=>{this.render(),this._resetNavStatus(),this.handleNavStatus()})),F(this,"onChangeCurrentView",(()=>{this.render(),this._resetNavStatus(),this.handleNavStatus()})),F(this,"onClickNavTitle",(()=>{this.dp.isFinalView||this.dp.up()})),F(this,"update",(()=>{let{prevHtml:e,nextHtml:t}=this.opts;this.$prev.innerHTML=e,this.$next.innerHTML=t,this._resetNavStatus(),this.render(),this.handleNavStatus()})),F(this,"renderDelay",(()=>{setTimeout(this.render)})),F(this,"render",(()=>{this.$title.innerHTML=this._getTitle(),function(e,t){for(let i in t)t[i]?e.classList.add(i):e.classList.remove(i)}(this.$title,{"-disabled-":this.dp.isFinalView})})),this.dp=t,this.opts=i,this.init()}init(){this._createElement(),this._buildBaseHtml(),this._defineDOM(),this.render(),this.handleNavStatus(),this._bindEvents(),this._bindDatepickerEvents()}_defineDOM(){this.$title=a(".air-datepicker-nav--title",this.$el),this.$prev=a('[data-action="prev"]',this.$el),this.$next=a('[data-action="next"]',this.$el)}_bindEvents(){this.$el.addEventListener("click",this.onClickNav),this.$title.addEventListener("click",this.onClickNavTitle)}_bindDatepickerEvents(){this.dp.on(i.eventChangeViewDate,this.onChangeViewDate),this.dp.on(i.eventChangeCurrentView,this.onChangeCurrentView),this.isNavIsFunction&&(this.dp.on(i.eventChangeSelectedDate,this.renderDelay),this.dp.opts.timepicker&&this.dp.on(i.eventChangeTime,this.render))}destroy(){this.dp.off(i.eventChangeViewDate,this.onChangeViewDate),this.dp.off(i.eventChangeCurrentView,this.onChangeCurrentView),this.isNavIsFunction&&(this.dp.off(i.eventChangeSelectedDate,this.renderDelay),this.dp.opts.timepicker&&this.dp.off(i.eventChangeTime,this.render))}_createElement(){this.$el=n({tagName:"nav",className:"air-datepicker-nav"})}_getTitle(){let{dp:e,opts:t}=this,i=t.navTitles[e.currentView];return"function"==typeof i?i(e):e.formatDate(e.viewDate,i)}handleNavStatus(){let{disableNavWhenOutOfRange:e}=this.opts,{minDate:t,maxDate:s}=this.dp;if(!t&&!s||!e)return;let{year:a,month:n}=this.dp.parsedViewDate,r=!!t&&o(t),h=!!s&&o(s);switch(this.dp.currentView){case i.days:t&&r.month>=n&&r.year>=a&&this._disableNav("prev"),s&&h.month<=n&&h.year<=a&&this._disableNav("next");break;case i.months:t&&r.year>=a&&this._disableNav("prev"),s&&h.year<=a&&this._disableNav("next");break;case i.years:{let e=c(this.dp.viewDate);t&&r.year>=e[0]&&this._disableNav("prev"),s&&h.year<=e[1]&&this._disableNav("next");break}}}_disableNav(e){a('[data-action="'+e+'"]',this.$el).classList.add("-disabled-")}_resetNavStatus(){!function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),s=1;s<t;s++)i[s-1]=arguments[s];e.length?e.forEach((e=>{e.classList.remove(...i)})):e.classList.remove(...i)}(this.$el.querySelectorAll(".air-datepicker-nav--action"),"-disabled-")}_buildBaseHtml(){let{prevHtml:e,nextHtml:t}=this.opts;this.$el.innerHTML=`<div class="air-datepicker-nav--action" data-action="prev">${e}</div><div class="air-datepicker-nav--title"></div><div class="air-datepicker-nav--action" data-action="next">${t}</div>`}get isNavIsFunction(){let{navTitles:e}=this.opts;return Object.keys(e).find((t=>"function"==typeof e[t]))}}var x={today:{content:e=>e.locale.today,onClick:e=>e.setViewDate(new Date)},clear:{content:e=>e.locale.clear,onClick:e=>e.clear()}};class H{constructor(e){let{dp:t,opts:i}=e;this.dp=t,this.opts=i,this.init()}init(){this.createElement(),this.render()}createElement(){this.$el=n({className:"air-datepicker-buttons"})}destroy(){this.$el.parentNode.removeChild(this.$el)}clearHtml(){return this.$el.innerHTML="",this}generateButtons(){let{buttons:e}=this.opts;Array.isArray(e)||(e=[e]),e.forEach((e=>{let t=e;"string"==typeof e&&x[e]&&(t=x[e]);let i=this.createButton(t);t.onClick&&this.attachEventToButton(i,t.onClick),this.$el.appendChild(i)}))}attachEventToButton(e,t){e.addEventListener("click",(()=>{t(this.dp)}))}createButton(e){let{content:t,className:i,tagName:s="button",attrs:a={}}=e;return n({tagName:s,innerHtml:`<span tabindex='-1'>${"function"==typeof t?t(this.dp):t}</span>`,className:u("air-datepicker-button",i),attrs:a})}render(){this.generateButtons()}}function E(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var s=i.call(e,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class L{constructor(){let{opts:e,dp:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};E(this,"toggleTimepickerIsActive",(e=>{this.dp.timepickerIsActive=e})),E(this,"onChangeSelectedDate",(e=>{let{date:t,updateTime:i=!1}=e;t&&(this.setMinMaxTime(t),this.setCurrentTime(!!i&&t),this.addTimeToDate(t))})),E(this,"onChangeLastSelectedDate",(e=>{e&&(this.setTime(e),this.render())})),E(this,"onChangeInputRange",(e=>{let t=e.target;this[t.getAttribute("name")]=t.value,this.updateText(),this.dp.trigger(i.eventChangeTime,{hours:this.hours,minutes:this.minutes})})),E(this,"onMouseEnterLeave",(e=>{let t=e.target.getAttribute("name"),i=this.$minutesText;"hours"===t&&(i=this.$hoursText),i.classList.toggle("-focus-")})),E(this,"onFocus",(()=>{this.toggleTimepickerIsActive(!0)})),E(this,"onBlur",(()=>{this.toggleTimepickerIsActive(!1)})),this.opts=e,this.dp=t;let{timeFormat:s}=this.dp.locale;s&&(s.match(k("h"))||s.match(k("hh")))&&(this.ampm=!0),this.init()}init(){this.setTime(this.dp.lastSelectedDate||this.dp.viewDate),this.createElement(),this.buildHtml(),this.defineDOM(),this.render(),this.bindDatepickerEvents(),this.bindDOMEvents()}bindDatepickerEvents(){this.dp.on(i.eventChangeSelectedDate,this.onChangeSelectedDate),this.dp.on(i.eventChangeLastSelectedDate,this.onChangeLastSelectedDate)}bindDOMEvents(){let e="input";navigator.userAgent.match(/trident/gi)&&(e="change"),D(this.$ranges,e,this.onChangeInputRange),D(this.$ranges,"mouseenter",this.onMouseEnterLeave),D(this.$ranges,"mouseleave",this.onMouseEnterLeave),D(this.$ranges,"focus",this.onFocus),D(this.$ranges,"mousedown",this.onFocus),D(this.$ranges,"blur",this.onBlur)}createElement(){this.$el=n({className:u("air-datepicker-time",{"-am-pm-":this.dp.ampm})})}destroy(){this.dp.off(i.eventChangeSelectedDate,this.onChangeSelectedDate),this.dp.off(i.eventChangeLastSelectedDate,this.onChangeLastSelectedDate),this.$el.parentNode.removeChild(this.$el)}buildHtml(){let{ampm:e,hours:t,displayHours:i,minutes:s,minHours:a,minMinutes:n,maxHours:r,maxMinutes:h,dayPeriod:o,opts:{hoursStep:l,minutesStep:c}}=this;this.$el.innerHTML=`<div class="air-datepicker-time--current">   <span class="air-datepicker-time--current-hours">${d(i)}</span>   <span class="air-datepicker-time--current-colon">:</span>   <span class="air-datepicker-time--current-minutes">${d(s)}</span>   `+(e?`<span class='air-datepicker-time--current-ampm'>${o}</span>`:"")+'</div><div class="air-datepicker-time--sliders">   <div class="air-datepicker-time--row">'+`      <input type="range" name="hours" value="${t}" min="${a}" max="${r}" step="${l}"/>   </div>   <div class="air-datepicker-time--row">`+`      <input type="range" name="minutes" value="${s}" min="${n}" max="${h}" step="${c}"/>   </div></div>`}defineDOM(){let e=e=>a(e,this.$el);this.$ranges=this.$el.querySelectorAll('[type="range"]'),this.$hours=e('[name="hours"]'),this.$minutes=e('[name="minutes"]'),this.$hoursText=e(".air-datepicker-time--current-hours"),this.$minutesText=e(".air-datepicker-time--current-minutes"),this.$ampm=e(".air-datepicker-time--current-ampm")}setTime(e){this.setMinMaxTime(e),this.setCurrentTime(e)}addTimeToDate(e){e&&(e.setHours(this.hours),e.setMinutes(this.minutes))}setMinMaxTime(e){if(this.setMinMaxTimeFromOptions(),e){let{minDate:t,maxDate:i}=this.dp;t&&p(e,t)&&this.setMinTimeFromMinDate(t),i&&p(e,i)&&this.setMaxTimeFromMaxDate(i)}}setCurrentTime(e){let{hours:t,minutes:i}=e?o(e):this;this.hours=f(t,this.minHours,this.maxHours),this.minutes=f(i,this.minMinutes,this.maxMinutes)}setMinMaxTimeFromOptions(){let{minHours:e,minMinutes:t,maxHours:i,maxMinutes:s}=this.opts;this.minHours=f(e,0,23),this.minMinutes=f(t,0,59),this.maxHours=f(i,0,23),this.maxMinutes=f(s,0,59)}setMinTimeFromMinDate(e){let{lastSelectedDate:t}=this.dp;this.minHours=e.getHours(),t&&t.getHours()>e.getHours()?this.minMinutes=this.opts.minMinutes:this.minMinutes=e.getMinutes()}setMaxTimeFromMaxDate(e){let{lastSelectedDate:t}=this.dp;this.maxHours=e.getHours(),t&&t.getHours()<e.getHours()?this.maxMinutes=this.opts.maxMinutes:this.maxMinutes=e.getMinutes()}updateSliders(){r(this.$hours,{min:this.minHours,max:this.maxHours}).value=this.hours,r(this.$minutes,{min:this.minMinutes,max:this.maxMinutes}).value=this.minutes}updateText(){this.$hoursText.innerHTML=d(this.displayHours),this.$minutesText.innerHTML=d(this.minutes),this.ampm&&(this.$ampm.innerHTML=this.dayPeriod)}set hours(e){this._hours=e;let{hours:t,dayPeriod:i}=l(e);this.displayHours=this.ampm?t:e,this.dayPeriod=i}get hours(){return this._hours}render(){this.updateSliders(),this.updateText()}}function O(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var s=i.call(e,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class A{constructor(e){let{dp:t,opts:i}=e;O(this,"pressedKeys",new Set),O(this,"hotKeys",new Map([[[["Control","ArrowRight"],["Control","ArrowUp"]],e=>e.month++],[[["Control","ArrowLeft"],["Control","ArrowDown"]],e=>e.month--],[[["Shift","ArrowRight"],["Shift","ArrowUp"]],e=>e.year++],[[["Shift","ArrowLeft"],["Shift","ArrowDown"]],e=>e.year--],[[["Alt","ArrowRight"],["Alt","ArrowUp"]],e=>e.year+=10],[[["Alt","ArrowLeft"],["Alt","ArrowDown"]],e=>e.year-=10],[["Control","Shift","ArrowUp"],(e,t)=>t.up()]])),O(this,"handleHotKey",(e=>{let t=this.hotKeys.get(e),i=o(this.getInitialFocusDate());t(i,this.dp);let{year:s,month:a,date:n}=i,r=h(new Date(s,a));r<n&&(n=r);let l=this.dp.getClampedDate(new Date(s,a,n));this.dp.setFocusDate(l,{viewDateTransition:!0})})),O(this,"isHotKeyPressed",(()=>{let e=!1,t=this.pressedKeys.size,i=e=>this.pressedKeys.has(e);for(let[s]of this.hotKeys){if(e)break;if(Array.isArray(s[0]))s.forEach((a=>{e||t!==a.length||(e=a.every(i)&&s)}));else{if(t!==s.length)continue;e=s.every(i)&&s}}return e})),O(this,"isArrow",(e=>e>=37&&e<=40)),O(this,"onKeyDown",(e=>{let{key:t,which:i}=e,{dp:s,dp:{focusDate:a},opts:n}=this;this.registerKey(t);let r=this.isHotKeyPressed();if(r)return e.preventDefault(),void this.handleHotKey(r);if(this.isArrow(i))return e.preventDefault(),void this.focusNextCell(t);if("Enter"===t){if(s.currentView!==n.minView)return void s.down();if(a){let e=s._checkIfDateIsSelected(a);return void(e?s._handleAlreadySelectedDates(e,a):s.selectDate(a))}}"Escape"===t&&this.dp.hide()})),O(this,"onKeyUp",(e=>{this.removeKey(e.key)})),this.dp=t,this.opts=i,this.init()}init(){this.bindKeyboardEvents()}bindKeyboardEvents(){let{$el:e}=this.dp;e.addEventListener("keydown",this.onKeyDown),e.addEventListener("keyup",this.onKeyUp)}destroy(){let{$el:e}=this.dp;e.removeEventListener("keydown",this.onKeyDown),e.removeEventListener("keyup",this.onKeyUp),this.hotKeys=null,this.pressedKeys=null}getInitialFocusDate(){let{focusDate:e,currentView:t,selectedDates:s,parsedViewDate:{year:a,month:n}}=this.dp,r=e||s[s.length-1];if(!r)switch(t){case i.days:r=new Date(a,n,(new Date).getDate());break;case i.months:r=new Date(a,n,1);break;case i.years:r=new Date(a,0,1)}return r}focusNextCell(e){let t=this.getInitialFocusDate(),{currentView:s}=this.dp,{days:a,months:n,years:r}=i,h=o(t),l=h.year,d=h.month,c=h.date;switch(e){case"ArrowLeft":s===a&&(c-=1),s===n&&(d-=1),s===r&&(l-=1);break;case"ArrowUp":s===a&&(c-=7),s===n&&(d-=3),s===r&&(l-=4);break;case"ArrowRight":s===a&&(c+=1),s===n&&(d+=1),s===r&&(l+=1);break;case"ArrowDown":s===a&&(c+=7),s===n&&(d+=3),s===r&&(l+=4)}let u=this.dp.getClampedDate(new Date(l,d,c));this.dp.setFocusDate(u,{viewDateTransition:!0})}registerKey(e){this.pressedKeys.add(e)}removeKey(e){this.pressedKeys.delete(e)}}let N={on(e,t){this.__events||(this.__events={}),this.__events[e]?this.__events[e].push(t):this.__events[e]=[t]},off(e,t){this.__events&&this.__events[e]&&(this.__events[e]=this.__events[e].filter((e=>e!==t)))},removeAllEvents(){this.__events={}},trigger(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),s=1;s<t;s++)i[s-1]=arguments[s];this.__events&&this.__events[e]&&this.__events[e].forEach((e=>{e(...i)}))}};function I(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var s=i.call(e,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}let P="",j="",R=!1;class B{static buildGlobalContainer(e){R=!0,P=n({className:e,id:e}),a("body").appendChild(P)}constructor(e,t){var r=this;if(I(this,"viewIndexes",[i.days,i.months,i.years]),I(this,"next",(()=>{let{year:e,month:t}=this.parsedViewDate;switch(this.currentView){case i.days:this.setViewDate(new Date(e,t+1,1));break;case i.months:this.setViewDate(new Date(e+1,t,1));break;case i.years:this.setViewDate(new Date(e+10,0,1))}})),I(this,"prev",(()=>{let{year:e,month:t}=this.parsedViewDate;switch(this.currentView){case i.days:this.setViewDate(new Date(e,t-1,1));break;case i.months:this.setViewDate(new Date(e-1,t,1));break;case i.years:this.setViewDate(new Date(e-10,0,1))}})),I(this,"_finishHide",(()=>{this.hideAnimation=!1,this._destroyComponents(),this.$container.removeChild(this.$datepicker)})),I(this,"setPosition",(function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("function"==typeof(e=e||r.opts.position))return void(r.customHide=e({$datepicker:r.$datepicker,$target:r.$el,$pointer:r.$pointer,isViewChange:t,done:r._finishHide}));let i,s,{isMobile:a}=r.opts,n=r.$el.getBoundingClientRect(),h=r.$el.getBoundingClientRect(),o=r.$datepicker.offsetParent,l=r.$el.offsetParent,d=r.$datepicker.getBoundingClientRect(),c=e.split(" "),u=window.scrollY,p=window.scrollX,m=r.opts.offset,v=c[0],g=c[1];if(a)r.$datepicker.style.cssText="left: 50%; top: 50%";else{if(o===l&&o!==document.body&&(h={top:r.$el.offsetTop,left:r.$el.offsetLeft,width:n.width,height:r.$el.offsetHeight},u=0,p=0),o!==l&&o!==document.body){let e=o.getBoundingClientRect();h={top:n.top-e.top,left:n.left-e.left,width:n.width,height:n.height},u=0,p=0}switch(v){case"top":i=h.top-d.height-m;break;case"right":s=h.left+h.width+m;break;case"bottom":i=h.top+h.height+m;break;case"left":s=h.left-d.width-m}switch(g){case"top":i=h.top;break;case"right":s=h.left+h.width-d.width;break;case"bottom":i=h.top+h.height-d.height;break;case"left":s=h.left;break;case"center":/left|right/.test(v)?i=h.top+h.height/2-d.height/2:s=h.left+h.width/2-d.width/2}r.$datepicker.style.cssText=`left: ${s+p}px; top: ${i+u}px`}})),I(this,"_setInputValue",(()=>{let{opts:e,$altField:t,locale:{dateFormat:i}}=this,{altFieldDateFormat:s,altField:a}=e;a&&t&&(t.value=this._getInputValue(s)),this.$el.value=this._getInputValue(i)})),I(this,"_getInputValue",(e=>{let{selectedDates:t,opts:i}=this,{multipleDates:s,multipleDatesSeparator:a}=i;if(!t.length)return"";let n="function"==typeof e,r=n?e(s?t:t[0]):t.map((t=>this.formatDate(t,e)));return r=n?r:r.join(a),r})),I(this,"_checkIfDateIsSelected",(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.days,s=!1;return r.selectedDates.some((i=>{let a=p(e,i,t);return s=a&&i,a})),s})),I(this,"_scheduleCallAfterTransition",(e=>{this._cancelScheduledCall(),e&&e(!1),this._onTransitionEnd=()=>{e&&e(!0)},this.$datepicker.addEventListener("transitionend",this._onTransitionEnd,{once:!0})})),I(this,"_cancelScheduledCall",(()=>{this.$datepicker.removeEventListener("transitionend",this._onTransitionEnd)})),I(this,"setViewDate",(e=>{if(!((e=b(e))instanceof Date))return;if(p(e,this.viewDate))return;let t=this.viewDate;this.viewDate=e;let{onChangeViewDate:s}=this.opts;if(s){let{month:e,year:t}=this.parsedViewDate;s({month:e,year:t,decade:this.curDecade})}this.trigger(i.eventChangeViewDate,e,t)})),I(this,"setFocusDate",(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(!e||(e=b(e))instanceof Date)&&(r.focusDate=e,r.opts.range&&e&&r._handleRangeOnFocus(),r.trigger(i.eventChangeFocusDate,e,t))})),I(this,"setCurrentView",(e=>{if(this.viewIndexes.includes(e)){if(this.currentView=e,this.elIsInput&&this.visible&&this.setPosition(void 0,!0),this.trigger(i.eventChangeCurrentView,e),!this.views[e]){let t=this.views[e]=new T({dp:this,opts:this.opts,type:e});this.shouldUpdateDOM&&this.$content.appendChild(t.$el)}this.opts.onChangeView&&this.opts.onChangeView(e)}})),I(this,"_updateLastSelectedDate",(e=>{this.lastSelectedDate=e,this.trigger(i.eventChangeLastSelectedDate,e)})),I(this,"destroy",(()=>{let{showEvent:e,isMobile:t}=this.opts,i=this.$datepicker.parentNode;i&&i.removeChild(this.$datepicker),this.$el.removeEventListener(e,this._onFocus),this.$el.removeEventListener("blur",this._onBlur),window.removeEventListener("resize",this._onResize),t&&this._removeMobileAttributes(),this.keyboardNav&&this.keyboardNav.destroy(),this.views=null,this.nav=null,this.$datepicker=null,this.opts=null,this.$customContainer=null,this.viewDate=null,this.focusDate=null,this.selectedDates=null,this.rangeDateFrom=null,this.rangeDateTo=null})),I(this,"update",(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=w({},r.opts);w(r.opts,e);let{timepicker:s,buttons:a,range:n,selectedDates:h,isMobile:o}=r.opts,l=r.visible||r.treatAsInline;r._createMinMaxDates(),r._limitViewDateByMaxMinDates(),r._handleLocale(),!t.selectedDates&&h&&r.selectDate(h),e.view&&r.setCurrentView(e.view),r._setInputValue(),t.range&&!n?(r.rangeDateTo=!1,r.rangeDateFrom=!1):!t.range&&n&&r.selectedDates.length&&(r.rangeDateFrom=r.selectedDates[0],r.rangeDateTo=r.selectedDates[1]),t.timepicker&&!s?(l&&r.timepicker.destroy(),r.timepicker=!1,r.$timepicker.parentNode.removeChild(r.$timepicker)):!t.timepicker&&s&&r._addTimepicker(),!t.buttons&&a?r._addButtons():t.buttons&&!a?(r.buttons.destroy(),r.$buttons.parentNode.removeChild(r.$buttons)):l&&t.buttons&&a&&r.buttons.clearHtml().render(),!t.isMobile&&o?(r.treatAsInline||j||r._createMobileOverlay(),r._addMobileAttributes(),r.visible&&r._showMobileOverlay()):t.isMobile&&!o&&(r._removeMobileAttributes(),r.visible&&(j.classList.remove("-active-"),"function"!=typeof r.opts.position&&r.setPosition())),l&&(r.nav.update(),r.views[r.currentView].render(),r.currentView===i.days&&r.views[r.currentView].renderDayNames())})),I(this,"isOtherMonth",(e=>{let{month:t}=o(e);return t!==this.parsedViewDate.month})),I(this,"isOtherYear",(e=>{let{year:t}=o(e);return t!==this.parsedViewDate.year})),I(this,"isOtherDecade",(e=>{let{year:t}=o(e),[i,s]=c(this.viewDate);return t<i||t>s})),I(this,"_onChangeSelectedDate",(e=>{let{silent:t}=e;setTimeout((()=>{this._setInputValue(),this.opts.onSelect&&!t&&this._triggerOnSelect()}))})),I(this,"_onChangeFocusedDate",(function(e){let{viewDateTransition:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e)return;let i=!1;t&&(i=r.isOtherMonth(e)||r.isOtherYear(e)||r.isOtherDecade(e)),i&&r.setViewDate(e),r.opts.onFocus&&r.opts.onFocus({datepicker:r,date:e})})),I(this,"_onChangeTime",(e=>{let{hours:t,minutes:i}=e,s=new Date,{lastSelectedDate:a,opts:{onSelect:n}}=this,r=a;a||(r=s);let h=this.getCell(r,this.currentViewSingular),o=h&&h.adpCell;o&&o.isDisabled||(r.setHours(t),r.setMinutes(i),a?(this._setInputValue(),n&&this._triggerOnSelect()):this.selectDate(r))})),I(this,"_onFocus",(e=>{this.visible||this.show()})),I(this,"_onBlur",(e=>{this.inFocus||!this.visible||this.opts.isMobile||this.hide()})),I(this,"_onMouseDown",(e=>{this.inFocus=!0})),I(this,"_onMouseUp",(e=>{this.inFocus=!1,this.$el.focus()})),I(this,"_onResize",(()=>{this.visible&&"function"!=typeof this.opts.position&&this.setPosition()})),I(this,"_onClickOverlay",(()=>{this.visible&&this.hide()})),I(this,"getViewDates",(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i.days;return T.getDatesFunction(e)(r)})),I(this,"isWeekend",(e=>this.opts.weekends.includes(e))),I(this,"getClampedDate",(e=>{let{minDate:t,maxDate:i}=this,s=e;return i&&m(e,i)?s=i:t&&v(e,t)&&(s=t),s})),this.$el=a(e),!this.$el)return;this.$datepicker=n({className:"air-datepicker"}),this.opts=w({},s,t),this.$customContainer=!!this.opts.container&&a(this.opts.container),this.$altField=a(this.opts.altField||!1);let{view:h,startDate:l}=this.opts;l||(this.opts.startDate=new Date),"INPUT"===this.$el.nodeName&&(this.elIsInput=!0),this.inited=!1,this.visible=!1,this.viewDate=b(this.opts.startDate),this.focusDate=!1,this.initialReadonly=this.$el.getAttribute("readonly"),this.customHide=!1,this.currentView=h,this.selectedDates=[],this.views={},this.keys=[],this.rangeDateFrom="",this.rangeDateTo="",this.timepickerIsActive=!1,this.treatAsInline=this.opts.inline||!this.elIsInput,this.init()}init(){let{opts:e,treatAsInline:t,opts:{inline:i,isMobile:s,selectedDates:n,keyboardNav:r,onlyTimepicker:h}}=this,o=a("body");(!R||R&&P&&!o.contains(P))&&!i&&this.elIsInput&&!this.$customContainer&&B.buildGlobalContainer(B.defaultGlobalContainerId),!s||j||t||this._createMobileOverlay(),this._handleLocale(),this._bindSubEvents(),this._createMinMaxDates(),this._limitViewDateByMaxMinDates(),this.elIsInput&&(i||this._bindEvents(),r&&!h&&(this.keyboardNav=new A({dp:this,opts:e}))),n&&this.selectDate(n,{silent:!0}),this.opts.visible&&!t&&this.show(),s&&!t&&this.$el.setAttribute("readonly",!0),t&&this._createComponents()}_createMobileOverlay(){j=n({className:"air-datepicker-overlay"}),P.appendChild(j)}_createComponents(){let{opts:e,treatAsInline:t,opts:{inline:i,buttons:s,timepicker:a,position:n,classes:r,onlyTimepicker:h,isMobile:o}}=this;this._buildBaseHtml(),this.elIsInput&&(i||this._setPositionClasses(n)),!i&&this.elIsInput||this.$datepicker.classList.add("-inline-"),r&&this.$datepicker.classList.add(...r.split(" ")),h&&this.$datepicker.classList.add("-only-timepicker-"),o&&!t&&this._addMobileAttributes(),this.views[this.currentView]=new T({dp:this,type:this.currentView,opts:e}),this.nav=new V({dp:this,opts:e}),a&&this._addTimepicker(),s&&this._addButtons(),this.$content.appendChild(this.views[this.currentView].$el),this.$nav.appendChild(this.nav.$el)}_destroyComponents(){for(let e in this.views)this.views[e].destroy();this.views={},this.nav.destroy(),this.timepicker&&this.timepicker.destroy()}_addMobileAttributes(){j.addEventListener("click",this._onClickOverlay),this.$datepicker.classList.add("-is-mobile-"),this.$el.setAttribute("readonly",!0)}_removeMobileAttributes(){j.removeEventListener("click",this._onClickOverlay),this.$datepicker.classList.remove("-is-mobile-"),this.initialReadonly||""===this.initialReadonly||this.$el.removeAttribute("readonly")}_createMinMaxDates(){let{minDate:e,maxDate:t}=this.opts;this.minDate=!!e&&b(e),this.maxDate=!!t&&b(t)}_addTimepicker(){this.$timepicker=n({className:"air-datepicker--time"}),this.$datepicker.appendChild(this.$timepicker),this.timepicker=new L({dp:this,opts:this.opts}),this.$timepicker.appendChild(this.timepicker.$el)}_addButtons(){this.$buttons=n({className:"air-datepicker--buttons"}),this.$datepicker.appendChild(this.$buttons),this.buttons=new H({dp:this,opts:this.opts}),this.$buttons.appendChild(this.buttons.$el)}_bindSubEvents(){this.on(i.eventChangeSelectedDate,this._onChangeSelectedDate),this.on(i.eventChangeFocusDate,this._onChangeFocusedDate),this.on(i.eventChangeTime,this._onChangeTime)}_buildBaseHtml(){let{inline:e}=this.opts;var t,i;this.elIsInput?e?(t=this.$datepicker,(i=this.$el).parentNode.insertBefore(t,i.nextSibling)):this.$container.appendChild(this.$datepicker):this.$el.appendChild(this.$datepicker),this.$datepicker.innerHTML='<i class="air-datepicker--pointer"></i><div class="air-datepicker--navigation"></div><div class="air-datepicker--content"></div>',this.$content=a(".air-datepicker--content",this.$datepicker),this.$pointer=a(".air-datepicker--pointer",this.$datepicker),this.$nav=a(".air-datepicker--navigation",this.$datepicker)}_handleLocale(){let{locale:e,dateFormat:t,firstDay:i,timepicker:s,onlyTimepicker:a,timeFormat:n,dateTimeSeparator:r}=this.opts;var h;this.locale=(h=e,JSON.parse(JSON.stringify(h))),t&&(this.locale.dateFormat=t),void 0!==n&&""!==n&&(this.locale.timeFormat=n);let{timeFormat:o}=this.locale;if(""!==i&&(this.locale.firstDay=i),s&&"function"!=typeof t){let e=o?r:"";this.locale.dateFormat=[this.locale.dateFormat,o||""].join(e)}a&&"function"!=typeof t&&(this.locale.dateFormat=this.locale.timeFormat)}_setPositionClasses(e){if("function"==typeof e)return void this.$datepicker.classList.add("-custom-position-");let t=(e=e.split(" "))[0],i=`air-datepicker -${t}-${e[1]}- -from-${t}-`;this.$datepicker.classList.add(...i.split(" "))}_bindEvents(){this.$el.addEventListener(this.opts.showEvent,this._onFocus),this.$el.addEventListener("blur",this._onBlur),this.$datepicker.addEventListener("mousedown",this._onMouseDown),this.$datepicker.addEventListener("mouseup",this._onMouseUp),window.addEventListener("resize",this._onResize)}_limitViewDateByMaxMinDates(){let{viewDate:e,minDate:t,maxDate:i}=this;i&&m(e,i)&&this.setViewDate(i),t&&v(e,t)&&this.setViewDate(t)}formatDate(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.viewDate,t=arguments.length>1?arguments[1]:void 0;if(e=b(e),!(e instanceof Date))return;let i=t,s=this.locale,a=o(e),n=a.dayPeriod,r=c(e),h=B.replacer,l={T:e.getTime(),m:a.minutes,mm:a.fullMinutes,h:a.hours12,hh:a.fullHours12,H:a.hours,HH:a.fullHours,aa:n,AA:n.toUpperCase(),E:s.daysShort[a.day],EEEE:s.days[a.day],d:a.date,dd:a.fullDate,M:a.month+1,MM:a.fullMonth,MMM:s.monthsShort[a.month],MMMM:s.months[a.month],yy:a.year.toString().slice(-2),yyyy:a.year,yyyy1:r[0],yyyy2:r[1]};for(let[e,t]of Object.entries(l))i=h(i,k(e),t);return i}down(e){this._handleUpDownActions(e,"down")}up(e){this._handleUpDownActions(e,"up")}selectDate(e){let t,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{currentView:a,parsedViewDate:n,selectedDates:r}=this,{updateTime:h}=s,{moveToOtherMonthsOnSelect:o,moveToOtherYearsOnSelect:l,multipleDates:d,range:c,autoClose:u,onBeforeSelect:p}=this.opts,v=r.length;if(Array.isArray(e))return e.forEach((e=>{this.selectDate(e,s)})),new Promise((e=>{setTimeout(e)}));if((e=b(e))instanceof Date){if(p&&!p({date:e,datepicker:this}))return Promise.resolve();if(a===i.days&&e.getMonth()!==n.month&&o&&(t=new Date(e.getFullYear(),e.getMonth(),1)),a===i.years&&e.getFullYear()!==n.year&&l&&(t=new Date(e.getFullYear(),0,1)),t&&this.setViewDate(t),d&&!c){if(v===d)return;this._checkIfDateIsSelected(e)||r.push(e)}else if(c)switch(v){case 1:r.push(e),this.rangeDateTo||(this.rangeDateTo=e),m(this.rangeDateFrom,this.rangeDateTo)&&(this.rangeDateTo=this.rangeDateFrom,this.rangeDateFrom=e),this.selectedDates=[this.rangeDateFrom,this.rangeDateTo];break;case 2:this.selectedDates=[e],this.rangeDateFrom=e,this.rangeDateTo="";break;default:this.selectedDates=[e],this.rangeDateFrom=e}else this.selectedDates=[e];return this.trigger(i.eventChangeSelectedDate,{action:i.actionSelectDate,silent:null==s?void 0:s.silent,date:e,updateTime:h}),this._updateLastSelectedDate(e),u&&!this.timepickerIsActive&&this.visible&&(d||c?c&&1===v&&this.hide():this.hide()),new Promise((e=>{setTimeout(e)}))}}unselectDate(e){let t=this.selectedDates,s=this;if((e=b(e))instanceof Date)return t.some(((a,n)=>{if(p(a,e))return t.splice(n,1),s.selectedDates.length?s._updateLastSelectedDate(s.selectedDates[s.selectedDates.length-1]):(s.rangeDateFrom="",s.rangeDateTo="",s._updateLastSelectedDate(!1)),this.trigger(i.eventChangeSelectedDate,{action:i.actionUnselectDate,date:e}),!0}))}replaceDate(e,t){let s=this.selectedDates.find((t=>p(t,e,this.currentView))),a=this.selectedDates.indexOf(s);a<0||p(this.selectedDates[a],t,this.currentView)||(this.selectedDates[a]=t,this.trigger(i.eventChangeSelectedDate,{action:i.actionSelectDate,date:t,updateTime:!0}),this._updateLastSelectedDate(t))}clear(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.selectedDates=[],this.rangeDateFrom=!1,this.rangeDateTo=!1,this.lastSelectedDate=!1,this.trigger(i.eventChangeSelectedDate,{action:i.actionUnselectDate,silent:e.silent}),new Promise((e=>{setTimeout(e)}))}show(){let{onShow:e,isMobile:t}=this.opts;this._cancelScheduledCall(),this.visible||this.hideAnimation||this._createComponents(),this.setPosition(this.opts.position),this.$datepicker.classList.add("-active-"),this.visible=!0,e&&this._scheduleCallAfterTransition(e),t&&this._showMobileOverlay()}hide(){let{onHide:e,isMobile:t}=this.opts,i=this._hasTransition();this.visible=!1,this.hideAnimation=!0,this.$datepicker.classList.remove("-active-"),this.customHide&&this.customHide(),this.elIsInput&&this.$el.blur(),this._scheduleCallAfterTransition((t=>{!this.customHide&&(t&&i||!t&&!i)&&this._finishHide(),e&&e(t)})),t&&j.classList.remove("-active-")}_triggerOnSelect(){let e=[],t=[],{selectedDates:i,locale:s,opts:{onSelect:a,multipleDates:n,range:r}}=this,h=n||r,o="function"==typeof s.dateFormat;i.length&&(e=i.map(g),t=o?n?s.dateFormat(e):e.map((e=>s.dateFormat(e))):e.map((e=>this.formatDate(e,s.dateFormat)))),a({date:h?e:e[0],formattedDate:h?t:t[0],datepicker:this})}_handleAlreadySelectedDates(e,t){const{range:i,toggleSelected:s}=this.opts;let a="function"==typeof s?s({datepicker:this,date:t}):s;i&&(a||2!==this.selectedDates.length&&this.selectDate(t)),a?this.unselectDate(t):this._updateLastSelectedDate(e)}_handleUpDownActions(e,t){if(!((e=b(e||this.focusDate||this.viewDate))instanceof Date))return;let i="up"===t?this.viewIndex+1:this.viewIndex-1;i>2&&(i=2),i<0&&(i=0),this.setViewDate(new Date(e.getFullYear(),e.getMonth(),1)),this.setCurrentView(this.viewIndexes[i])}_handleRangeOnFocus(){1===this.selectedDates.length&&(m(this.selectedDates[0],this.focusDate)?(this.rangeDateTo=this.selectedDates[0],this.rangeDateFrom=this.focusDate):(this.rangeDateTo=this.focusDate,this.rangeDateFrom=this.selectedDates[0]))}getCell(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.day;if(!((e=b(e))instanceof Date))return;let{year:s,month:a,date:n}=o(e),r=`[data-year="${s}"]`,h=`[data-month="${a}"]`,l={[i.day]:`${r}${h}[data-date="${n}"]`,[i.month]:`${r}${h}`,[i.year]:`${r}`};return this.views[this.currentView].$el.querySelector(l[t])}_showMobileOverlay(){j.classList.add("-active-")}_hasTransition(){return window.getComputedStyle(this.$datepicker).getPropertyValue("transition-duration").split(", ").reduce(((e,t)=>parseFloat(t)+e),0)>0}get shouldUpdateDOM(){return this.visible||this.treatAsInline}get parsedViewDate(){return o(this.viewDate)}get currentViewSingular(){return this.currentView.slice(0,-1)}get curDecade(){return c(this.viewDate)}get viewIndex(){return this.viewIndexes.indexOf(this.currentView)}get isFinalView(){return this.currentView===i.years}get hasSelectedDates(){return this.selectedDates.length>0}get isMinViewReached(){return this.currentView===this.opts.minView||this.currentView===i.days}get $container(){return this.$customContainer||P}static replacer(e,t,i){return e.replace(t,(function(e,t,s,a){return t+i+a}))}}var K;return I(B,"defaults",s),I(B,"version","3.4.0"),I(B,"defaultGlobalContainerId","air-datepicker-global-container"),K=B.prototype,Object.assign(K,N),t.default}()}));
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiIiwic291cmNlcyI6WyJhaXItZGF0ZXBpY2tlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIhZnVuY3Rpb24oZSx0KXtcIm9iamVjdFwiPT10eXBlb2YgZXhwb3J0cyYmXCJvYmplY3RcIj09dHlwZW9mIG1vZHVsZT9tb2R1bGUuZXhwb3J0cz10KCk6XCJmdW5jdGlvblwiPT10eXBlb2YgZGVmaW5lJiZkZWZpbmUuYW1kP2RlZmluZShbXSx0KTpcIm9iamVjdFwiPT10eXBlb2YgZXhwb3J0cz9leHBvcnRzLkFpckRhdGVwaWNrZXI9dCgpOmUuQWlyRGF0ZXBpY2tlcj10KCl9KHRoaXMsKGZ1bmN0aW9uKCl7cmV0dXJuIGZ1bmN0aW9uKCl7XCJ1c2Ugc3RyaWN0XCI7dmFyIGU9e2Q6ZnVuY3Rpb24odCxpKXtmb3IodmFyIHMgaW4gaSllLm8oaSxzKSYmIWUubyh0LHMpJiZPYmplY3QuZGVmaW5lUHJvcGVydHkodCxzLHtlbnVtZXJhYmxlOiEwLGdldDppW3NdfSl9LG86ZnVuY3Rpb24oZSx0KXtyZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGUsdCl9fSx0PXt9O2UuZCh0LHtkZWZhdWx0OmZ1bmN0aW9uKCl7cmV0dXJuIEJ9fSk7dmFyIGk9e2RheXM6XCJkYXlzXCIsbW9udGhzOlwibW9udGhzXCIseWVhcnM6XCJ5ZWFyc1wiLGRheTpcImRheVwiLG1vbnRoOlwibW9udGhcIix5ZWFyOlwieWVhclwiLGV2ZW50Q2hhbmdlVmlld0RhdGU6XCJjaGFuZ2VWaWV3RGF0ZVwiLGV2ZW50Q2hhbmdlQ3VycmVudFZpZXc6XCJjaGFuZ2VDdXJyZW50Vmlld1wiLGV2ZW50Q2hhbmdlRm9jdXNEYXRlOlwiY2hhbmdlRm9jdXNEYXRlXCIsZXZlbnRDaGFuZ2VTZWxlY3RlZERhdGU6XCJjaGFuZ2VTZWxlY3RlZERhdGVcIixldmVudENoYW5nZVRpbWU6XCJjaGFuZ2VUaW1lXCIsZXZlbnRDaGFuZ2VMYXN0U2VsZWN0ZWREYXRlOlwiY2hhbmdlTGFzdFNlbGVjdGVkRGF0ZVwiLGFjdGlvblNlbGVjdERhdGU6XCJzZWxlY3REYXRlXCIsYWN0aW9uVW5zZWxlY3REYXRlOlwidW5zZWxlY3REYXRlXCIsY3NzQ2xhc3NXZWVrZW5kOlwiLXdlZWtlbmQtXCJ9LHM9e2NsYXNzZXM6XCJcIixpbmxpbmU6ITEsbG9jYWxlOntkYXlzOltcItCS0L7RgdC60YDQtdGB0LXQvdGM0LVcIixcItCf0L7QvdC10LTQtdC70YzQvdC40LpcIixcItCS0YLQvtGA0L3QuNC6XCIsXCLQodGA0LXQtNCwXCIsXCLQp9C10YLQstC10YDQs1wiLFwi0J/Rj9GC0L3QuNGG0LBcIixcItCh0YPQsdCx0L7RgtCwXCJdLGRheXNTaG9ydDpbXCLQktC+0YFcIixcItCf0L7QvVwiLFwi0JLRgtC+XCIsXCLQodGA0LVcIixcItCn0LXRglwiLFwi0J/Rj9GCXCIsXCLQodGD0LFcIl0sZGF5c01pbjpbXCLQktGBXCIsXCLQn9C9XCIsXCLQktGCXCIsXCLQodGAXCIsXCLQp9GCXCIsXCLQn9GCXCIsXCLQodCxXCJdLG1vbnRoczpbXCLQr9C90LLQsNGA0YxcIixcItCk0LXQstGA0LDQu9GMXCIsXCLQnNCw0YDRglwiLFwi0JDQv9GA0LXQu9GMXCIsXCLQnNCw0LlcIixcItCY0Y7QvdGMXCIsXCLQmNGO0LvRjFwiLFwi0JDQstCz0YPRgdGCXCIsXCLQodC10L3RgtGP0LHRgNGMXCIsXCLQntC60YLRj9Cx0YDRjFwiLFwi0J3QvtGP0LHRgNGMXCIsXCLQlNC10LrQsNCx0YDRjFwiXSxtb250aHNTaG9ydDpbXCLQr9C90LJcIixcItCk0LXQslwiLFwi0JzQsNGAXCIsXCLQkNC/0YBcIixcItCc0LDQuVwiLFwi0JjRjtC9XCIsXCLQmNGO0LtcIixcItCQ0LLQs1wiLFwi0KHQtdC9XCIsXCLQntC60YJcIixcItCd0L7Rj1wiLFwi0JTQtdC6XCJdLHRvZGF5Olwi0KHQtdCz0L7QtNC90Y9cIixjbGVhcjpcItCe0YfQuNGB0YLQuNGC0YxcIixkYXRlRm9ybWF0OlwiZGQuTU0ueXl5eVwiLHRpbWVGb3JtYXQ6XCJISDptbVwiLGZpcnN0RGF5OjF9LHN0YXJ0RGF0ZTpuZXcgRGF0ZSxmaXJzdERheTpcIlwiLHdlZWtlbmRzOls2LDBdLGRhdGVGb3JtYXQ6XCJcIixhbHRGaWVsZDpcIlwiLGFsdEZpZWxkRGF0ZUZvcm1hdDpcIlRcIix0b2dnbGVTZWxlY3RlZDohMCxrZXlib2FyZE5hdjohMCxzZWxlY3RlZERhdGVzOiExLGNvbnRhaW5lcjpcIlwiLGlzTW9iaWxlOiExLHZpc2libGU6ITEscG9zaXRpb246XCJib3R0b20gbGVmdFwiLG9mZnNldDoxMix2aWV3OmkuZGF5cyxtaW5WaWV3OmkuZGF5cyxzaG93T3RoZXJNb250aHM6ITAsc2VsZWN0T3RoZXJNb250aHM6ITAsbW92ZVRvT3RoZXJNb250aHNPblNlbGVjdDohMCxzaG93T3RoZXJZZWFyczohMCxzZWxlY3RPdGhlclllYXJzOiEwLG1vdmVUb090aGVyWWVhcnNPblNlbGVjdDohMCxtaW5EYXRlOlwiXCIsbWF4RGF0ZTpcIlwiLGRpc2FibGVOYXZXaGVuT3V0T2ZSYW5nZTohMCxtdWx0aXBsZURhdGVzOiExLG11bHRpcGxlRGF0ZXNTZXBhcmF0b3I6XCIsIFwiLHJhbmdlOiExLGR5bmFtaWNSYW5nZTohMCxidXR0b25zOiExLG1vbnRoc0ZpZWxkOlwibW9udGhzU2hvcnRcIixzaG93RXZlbnQ6XCJmb2N1c1wiLGF1dG9DbG9zZTohMSxwcmV2SHRtbDonPHN2Zz48cGF0aCBkPVwiTSAxNywxMiBsIC01LDUgbCA1LDVcIj48L3BhdGg+PC9zdmc+JyxuZXh0SHRtbDonPHN2Zz48cGF0aCBkPVwiTSAxNCwxMiBsIDUsNSBsIC01LDVcIj48L3BhdGg+PC9zdmc+JyxuYXZUaXRsZXM6e2RheXM6XCJNTU1NLCA8aT55eXl5PC9pPlwiLG1vbnRoczpcInl5eXlcIix5ZWFyczpcInl5eXkxIC0geXl5eTJcIn0sdGltZXBpY2tlcjohMSxvbmx5VGltZXBpY2tlcjohMSxkYXRlVGltZVNlcGFyYXRvcjpcIiBcIix0aW1lRm9ybWF0OlwiXCIsbWluSG91cnM6MCxtYXhIb3VyczoyNCxtaW5NaW51dGVzOjAsbWF4TWludXRlczo1OSxob3Vyc1N0ZXA6MSxtaW51dGVzU3RlcDoxLG9uU2VsZWN0OiExLG9uQ2hhbmdlVmlld0RhdGU6ITEsb25DaGFuZ2VWaWV3OiExLG9uUmVuZGVyQ2VsbDohMSxvblNob3c6ITEsb25IaWRlOiExLG9uQ2xpY2tEYXlOYW1lOiExfTtmdW5jdGlvbiBhKGUpe2xldCB0PWFyZ3VtZW50cy5sZW5ndGg+MSYmdm9pZCAwIT09YXJndW1lbnRzWzFdP2FyZ3VtZW50c1sxXTpkb2N1bWVudDtyZXR1cm5cInN0cmluZ1wiPT10eXBlb2YgZT90LnF1ZXJ5U2VsZWN0b3IoZSk6ZX1mdW5jdGlvbiBuKCl7bGV0e3RhZ05hbWU6ZT1cImRpdlwiLGNsYXNzTmFtZTp0PVwiXCIsaW5uZXJIdG1sOmk9XCJcIixpZDpzPVwiXCIsYXR0cnM6YT17fX09YXJndW1lbnRzLmxlbmd0aD4wJiZ2b2lkIDAhPT1hcmd1bWVudHNbMF0/YXJndW1lbnRzWzBdOnt9LG49ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChlKTtyZXR1cm4gdCYmbi5jbGFzc0xpc3QuYWRkKC4uLnQuc3BsaXQoXCIgXCIpKSxzJiYobi5pZD1zKSxpJiYobi5pbm5lckhUTUw9aSksYSYmcihuLGEpLG59ZnVuY3Rpb24gcihlLHQpe2ZvcihsZXRbaSxzXW9mIE9iamVjdC5lbnRyaWVzKHQpKXZvaWQgMCE9PXMmJmUuc2V0QXR0cmlidXRlKGkscyk7cmV0dXJuIGV9ZnVuY3Rpb24gaChlKXtyZXR1cm4gbmV3IERhdGUoZS5nZXRGdWxsWWVhcigpLGUuZ2V0TW9udGgoKSsxLDApLmdldERhdGUoKX1mdW5jdGlvbiBvKGUpe2xldCB0PWUuZ2V0SG91cnMoKSx7aG91cnM6aSxkYXlQZXJpb2Q6c309bCh0KTtyZXR1cm57eWVhcjplLmdldEZ1bGxZZWFyKCksbW9udGg6ZS5nZXRNb250aCgpLGZ1bGxNb250aDplLmdldE1vbnRoKCkrMTwxMD9cIjBcIisoZS5nZXRNb250aCgpKzEpOmUuZ2V0TW9udGgoKSsxLGRhdGU6ZS5nZXREYXRlKCksZnVsbERhdGU6ZS5nZXREYXRlKCk8MTA/XCIwXCIrZS5nZXREYXRlKCk6ZS5nZXREYXRlKCksZGF5OmUuZ2V0RGF5KCksaG91cnM6dCxmdWxsSG91cnM6ZCh0KSxob3VyczEyOmksZGF5UGVyaW9kOnMsZnVsbEhvdXJzMTI6ZChpKSxtaW51dGVzOmUuZ2V0TWludXRlcygpLGZ1bGxNaW51dGVzOmUuZ2V0TWludXRlcygpPDEwP1wiMFwiK2UuZ2V0TWludXRlcygpOmUuZ2V0TWludXRlcygpfX1mdW5jdGlvbiBsKGUpe3JldHVybntkYXlQZXJpb2Q6ZT4xMT9cInBtXCI6XCJhbVwiLGhvdXJzOmUlMTI9PTA/MTI6ZSUxMn19ZnVuY3Rpb24gZChlKXtyZXR1cm4gZTwxMD9cIjBcIitlOmV9ZnVuY3Rpb24gYyhlKXtsZXQgdD0xMCpNYXRoLmZsb29yKGUuZ2V0RnVsbFllYXIoKS8xMCk7cmV0dXJuW3QsdCs5XX1mdW5jdGlvbiB1KCl7bGV0IGU9W107Zm9yKHZhciB0PWFyZ3VtZW50cy5sZW5ndGgsaT1uZXcgQXJyYXkodCkscz0wO3M8dDtzKyspaVtzXT1hcmd1bWVudHNbc107cmV0dXJuIGkuZm9yRWFjaCgodD0+e2lmKFwib2JqZWN0XCI9PXR5cGVvZiB0KWZvcihsZXQgaSBpbiB0KXRbaV0mJmUucHVzaChpKTtlbHNlIHQmJmUucHVzaCh0KX0pKSxlLmpvaW4oXCIgXCIpfWZ1bmN0aW9uIHAoZSx0KXtsZXQgcz1hcmd1bWVudHMubGVuZ3RoPjImJnZvaWQgMCE9PWFyZ3VtZW50c1syXT9hcmd1bWVudHNbMl06aS5kYXlzO2lmKCFlfHwhdClyZXR1cm4hMTtsZXQgYT1vKGUpLG49byh0KTtyZXR1cm57W2kuZGF5c106YS5kYXRlPT09bi5kYXRlJiZhLm1vbnRoPT09bi5tb250aCYmYS55ZWFyPT09bi55ZWFyLFtpLm1vbnRoc106YS5tb250aD09PW4ubW9udGgmJmEueWVhcj09PW4ueWVhcixbaS55ZWFyc106YS55ZWFyPT09bi55ZWFyfVtzXX1mdW5jdGlvbiBtKGUsdCxpKXtsZXQgcz1nKGUsITEpLmdldFRpbWUoKSxhPWcodCwhMSkuZ2V0VGltZSgpO3JldHVybiBpP3M+PWE6cz5hfWZ1bmN0aW9uIHYoZSx0KXtyZXR1cm4hbShlLHQsITApfWZ1bmN0aW9uIGcoZSl7bGV0IHQ9IShhcmd1bWVudHMubGVuZ3RoPjEmJnZvaWQgMCE9PWFyZ3VtZW50c1sxXSl8fGFyZ3VtZW50c1sxXSxpPW5ldyBEYXRlKGUuZ2V0VGltZSgpKTtyZXR1cm5cImJvb2xlYW5cIiE9dHlwZW9mIHR8fHR8fGZ1bmN0aW9uKGUpe2Uuc2V0SG91cnMoMCwwLDAsMCl9KGkpLGl9ZnVuY3Rpb24gRChlLHQsaSl7ZS5sZW5ndGg/ZS5mb3JFYWNoKChlPT57ZS5hZGRFdmVudExpc3RlbmVyKHQsaSl9KSk6ZS5hZGRFdmVudExpc3RlbmVyKHQsaSl9ZnVuY3Rpb24geShlLHQpe3JldHVybiEoIWV8fGU9PT1kb2N1bWVudHx8ZSBpbnN0YW5jZW9mIERvY3VtZW50RnJhZ21lbnQpJiYoZS5tYXRjaGVzKHQpP2U6eShlLnBhcmVudE5vZGUsdCkpfWZ1bmN0aW9uIGYoZSx0LGkpe3JldHVybiBlPmk/aTplPHQ/dDplfWZ1bmN0aW9uIHcoZSl7Zm9yKHZhciB0PWFyZ3VtZW50cy5sZW5ndGgsaT1uZXcgQXJyYXkodD4xP3QtMTowKSxzPTE7czx0O3MrKylpW3MtMV09YXJndW1lbnRzW3NdO3JldHVybiBpLmZpbHRlcigoZT0+ZSkpLmZvckVhY2goKHQ9Pntmb3IobGV0W2ksc11vZiBPYmplY3QuZW50cmllcyh0KSlpZih2b2lkIDAhPT1zJiZcIltvYmplY3QgT2JqZWN0XVwiPT09cy50b1N0cmluZygpKXtsZXQgdD12b2lkIDAhPT1lW2ldP2VbaV0udG9TdHJpbmcoKTp2b2lkIDAsYT1zLnRvU3RyaW5nKCksbj1BcnJheS5pc0FycmF5KHMpP1tdOnt9O2VbaV09ZVtpXT90IT09YT9uOmVbaV06bix3KGVbaV0scyl9ZWxzZSBlW2ldPXN9KSksZX1mdW5jdGlvbiBiKGUpe2xldCB0PWU7cmV0dXJuIGUgaW5zdGFuY2VvZiBEYXRlfHwodD1uZXcgRGF0ZShlKSksaXNOYU4odC5nZXRUaW1lKCkpJiYoY29uc29sZS5sb2coYFVuYWJsZSB0byBjb252ZXJ0IHZhbHVlIFwiJHtlfVwiIHRvIERhdGUgb2JqZWN0YCksdD0hMSksdH1mdW5jdGlvbiBrKGUpe2xldCB0PVwiXFxcXHN8XFxcXC58LXwvfFxcXFxcXFxcfCx8XFxcXCR8XFxcXCF8XFxcXD98Onw7XCI7cmV0dXJuIG5ldyBSZWdFeHAoXCIoXnw+fFwiK3QrXCIpKFwiK2UrXCIpKCR8PHxcIit0K1wiKVwiLFwiZ1wiKX1mdW5jdGlvbiAkKGUsdCxpKXtyZXR1cm4odD1mdW5jdGlvbihlKXt2YXIgdD1mdW5jdGlvbihlLHQpe2lmKFwib2JqZWN0XCIhPXR5cGVvZiBlfHxudWxsPT09ZSlyZXR1cm4gZTt2YXIgaT1lW1N5bWJvbC50b1ByaW1pdGl2ZV07aWYodm9pZCAwIT09aSl7dmFyIHM9aS5jYWxsKGUsXCJzdHJpbmdcIik7aWYoXCJvYmplY3RcIiE9dHlwZW9mIHMpcmV0dXJuIHM7dGhyb3cgbmV3IFR5cGVFcnJvcihcIkBAdG9QcmltaXRpdmUgbXVzdCByZXR1cm4gYSBwcmltaXRpdmUgdmFsdWUuXCIpfXJldHVybiBTdHJpbmcoZSl9KGUpO3JldHVyblwic3ltYm9sXCI9PXR5cGVvZiB0P3Q6U3RyaW5nKHQpfSh0KSlpbiBlP09iamVjdC5kZWZpbmVQcm9wZXJ0eShlLHQse3ZhbHVlOmksZW51bWVyYWJsZTohMCxjb25maWd1cmFibGU6ITAsd3JpdGFibGU6ITB9KTplW3RdPWksZX1jbGFzcyBDe2NvbnN0cnVjdG9yKCl7bGV0e3R5cGU6ZSxkYXRlOnQsZHA6aSxvcHRzOnMsYm9keTphfT1hcmd1bWVudHMubGVuZ3RoPjAmJnZvaWQgMCE9PWFyZ3VtZW50c1swXT9hcmd1bWVudHNbMF06e307JCh0aGlzLFwiZm9jdXNcIiwoKCk9Pnt0aGlzLiRjZWxsLmNsYXNzTGlzdC5hZGQoXCItZm9jdXMtXCIpLHRoaXMuZm9jdXNlZD0hMH0pKSwkKHRoaXMsXCJyZW1vdmVGb2N1c1wiLCgoKT0+e3RoaXMuJGNlbGwuY2xhc3NMaXN0LnJlbW92ZShcIi1mb2N1cy1cIiksdGhpcy5mb2N1c2VkPSExfSkpLCQodGhpcyxcInNlbGVjdFwiLCgoKT0+e3RoaXMuJGNlbGwuY2xhc3NMaXN0LmFkZChcIi1zZWxlY3RlZC1cIiksdGhpcy5zZWxlY3RlZD0hMH0pKSwkKHRoaXMsXCJyZW1vdmVTZWxlY3RcIiwoKCk9Pnt0aGlzLiRjZWxsLmNsYXNzTGlzdC5yZW1vdmUoXCItc2VsZWN0ZWQtXCIsXCItcmFuZ2UtZnJvbS1cIixcIi1yYW5nZS10by1cIiksdGhpcy5zZWxlY3RlZD0hMX0pKSwkKHRoaXMsXCJvbkNoYW5nZVNlbGVjdGVkRGF0ZVwiLCgoKT0+e3RoaXMuaXNEaXNhYmxlZHx8KHRoaXMuX2hhbmRsZVNlbGVjdGVkU3RhdHVzKCksdGhpcy5vcHRzLnJhbmdlJiZ0aGlzLl9oYW5kbGVSYW5nZVN0YXR1cygpKX0pKSwkKHRoaXMsXCJvbkNoYW5nZUZvY3VzRGF0ZVwiLChlPT57aWYoIWUpcmV0dXJuIHZvaWQodGhpcy5mb2N1c2VkJiZ0aGlzLnJlbW92ZUZvY3VzKCkpO2xldCB0PXAoZSx0aGlzLmRhdGUsdGhpcy50eXBlKTt0P3RoaXMuZm9jdXMoKTohdCYmdGhpcy5mb2N1c2VkJiZ0aGlzLnJlbW92ZUZvY3VzKCksdGhpcy5vcHRzLnJhbmdlJiZ0aGlzLl9oYW5kbGVSYW5nZVN0YXR1cygpfSkpLCQodGhpcyxcInJlbmRlclwiLCgoKT0+KHRoaXMuJGNlbGwuaW5uZXJIVE1MPXRoaXMuX2dldEh0bWwoKSx0aGlzLiRjZWxsLmFkcENlbGw9dGhpcyx0aGlzLiRjZWxsKSkpLHRoaXMudHlwZT1lLHRoaXMuc2luZ2xlVHlwZT10aGlzLnR5cGUuc2xpY2UoMCwtMSksdGhpcy5kYXRlPXQsdGhpcy5kcD1pLHRoaXMub3B0cz1zLHRoaXMuYm9keT1hLHRoaXMuY3VzdG9tRGF0YT0hMSx0aGlzLmluaXQoKX1pbml0KCl7bGV0e3JhbmdlOmUsb25SZW5kZXJDZWxsOnR9PXRoaXMub3B0czt0JiYodGhpcy5jdXN0b21EYXRhPXQoe2RhdGU6dGhpcy5kYXRlLGNlbGxUeXBlOnRoaXMuc2luZ2xlVHlwZSxkYXRlcGlja2VyOnRoaXMuZHB9KSksdGhpcy5fY3JlYXRlRWxlbWVudCgpLHRoaXMuX2JpbmREYXRlcGlja2VyRXZlbnRzKCksdGhpcy5faGFuZGxlSW5pdGlhbEZvY3VzU3RhdHVzKCksdGhpcy5kcC5oYXNTZWxlY3RlZERhdGVzJiYodGhpcy5faGFuZGxlU2VsZWN0ZWRTdGF0dXMoKSxlJiZ0aGlzLl9oYW5kbGVSYW5nZVN0YXR1cygpKX1fYmluZERhdGVwaWNrZXJFdmVudHMoKXt0aGlzLmRwLm9uKGkuZXZlbnRDaGFuZ2VTZWxlY3RlZERhdGUsdGhpcy5vbkNoYW5nZVNlbGVjdGVkRGF0ZSksdGhpcy5kcC5vbihpLmV2ZW50Q2hhbmdlRm9jdXNEYXRlLHRoaXMub25DaGFuZ2VGb2N1c0RhdGUpfXVuYmluZERhdGVwaWNrZXJFdmVudHMoKXt0aGlzLmRwLm9mZihpLmV2ZW50Q2hhbmdlU2VsZWN0ZWREYXRlLHRoaXMub25DaGFuZ2VTZWxlY3RlZERhdGUpLHRoaXMuZHAub2ZmKGkuZXZlbnRDaGFuZ2VGb2N1c0RhdGUsdGhpcy5vbkNoYW5nZUZvY3VzRGF0ZSl9X2NyZWF0ZUVsZW1lbnQoKXt2YXIgZTtsZXR7eWVhcjp0LG1vbnRoOmksZGF0ZTpzfT1vKHRoaXMuZGF0ZSksYT0obnVsbD09PShlPXRoaXMuY3VzdG9tRGF0YSl8fHZvaWQgMD09PWU/dm9pZCAwOmUuYXR0cnMpfHx7fTt0aGlzLiRjZWxsPW4oe2NsYXNzTmFtZTp0aGlzLl9nZXRDbGFzc05hbWUoKSxhdHRyczp7XCJkYXRhLXllYXJcIjp0LFwiZGF0YS1tb250aFwiOmksXCJkYXRhLWRhdGVcIjpzLC4uLmF9fSl9X2dldENsYXNzTmFtZSgpe3ZhciBlLHQ7bGV0IHM9bmV3IERhdGUse3NlbGVjdE90aGVyTW9udGhzOmEsc2VsZWN0T3RoZXJZZWFyczpufT10aGlzLm9wdHMse21pbkRhdGU6cixtYXhEYXRlOmh9PXRoaXMuZHAse2RheTpsfT1vKHRoaXMuZGF0ZSksZD10aGlzLl9pc091dE9mTWluTWF4UmFuZ2UoKSxjPW51bGw9PT0oZT10aGlzLmN1c3RvbURhdGEpfHx2b2lkIDA9PT1lP3ZvaWQgMDplLmRpc2FibGVkLG09dShcImFpci1kYXRlcGlja2VyLWNlbGxcIixgLSR7dGhpcy5zaW5nbGVUeXBlfS1gLHtcIi1jdXJyZW50LVwiOnAocyx0aGlzLmRhdGUsdGhpcy50eXBlKSxcIi1taW4tZGF0ZS1cIjpyJiZwKHIsdGhpcy5kYXRlLHRoaXMudHlwZSksXCItbWF4LWRhdGUtXCI6aCYmcChoLHRoaXMuZGF0ZSx0aGlzLnR5cGUpfSksdj1cIlwiO3N3aXRjaCh0aGlzLnR5cGUpe2Nhc2UgaS5kYXlzOnY9dSh7XCItd2Vla2VuZC1cIjp0aGlzLmRwLmlzV2Vla2VuZChsKSxcIi1vdGhlci1tb250aC1cIjp0aGlzLmlzT3RoZXJNb250aCxcIi1kaXNhYmxlZC1cIjp0aGlzLmlzT3RoZXJNb250aCYmIWF8fGR8fGN9KTticmVhaztjYXNlIGkubW9udGhzOnY9dSh7XCItZGlzYWJsZWQtXCI6ZHx8Y30pO2JyZWFrO2Nhc2UgaS55ZWFyczp2PXUoe1wiLW90aGVyLWRlY2FkZS1cIjp0aGlzLmlzT3RoZXJEZWNhZGUsXCItZGlzYWJsZWQtXCI6ZHx8dGhpcy5pc090aGVyRGVjYWRlJiYhbnx8Y30pfXJldHVybiB1KG0sdixudWxsPT09KHQ9dGhpcy5jdXN0b21EYXRhKXx8dm9pZCAwPT09dD92b2lkIDA6dC5jbGFzc2VzKX1fZ2V0SHRtbCgpe3ZhciBlO2xldHt5ZWFyOnQsbW9udGg6cyxkYXRlOmF9PW8odGhpcy5kYXRlKSx7c2hvd090aGVyTW9udGhzOm4sc2hvd090aGVyWWVhcnM6cn09dGhpcy5vcHRzO2lmKG51bGwhPT0oZT10aGlzLmN1c3RvbURhdGEpJiZ2b2lkIDAhPT1lJiZlLmh0bWwpcmV0dXJuIHRoaXMuY3VzdG9tRGF0YS5odG1sO3N3aXRjaCh0aGlzLnR5cGUpe2Nhc2UgaS5kYXlzOnJldHVybiFuJiZ0aGlzLmlzT3RoZXJNb250aD9cIlwiOmE7Y2FzZSBpLm1vbnRoczpyZXR1cm4gdGhpcy5kcC5sb2NhbGVbdGhpcy5vcHRzLm1vbnRoc0ZpZWxkXVtzXTtjYXNlIGkueWVhcnM6cmV0dXJuIXImJnRoaXMuaXNPdGhlckRlY2FkZT9cIlwiOnR9fV9pc091dE9mTWluTWF4UmFuZ2UoKXtsZXR7bWluRGF0ZTplLG1heERhdGU6dH09dGhpcy5kcCx7dHlwZTpzLGRhdGU6YX09dGhpcyx7bW9udGg6bix5ZWFyOnIsZGF0ZTpofT1vKGEpLGw9cz09PWkuZGF5cyxkPXM9PT1pLnllYXJzLGM9ISFlJiZuZXcgRGF0ZShyLGQ/ZS5nZXRNb250aCgpOm4sbD9oOmUuZ2V0RGF0ZSgpKSx1PSEhdCYmbmV3IERhdGUocixkP3QuZ2V0TW9udGgoKTpuLGw/aDp0LmdldERhdGUoKSk7cmV0dXJuIGUmJnQ/dihjLGUpfHxtKHUsdCk6ZT92KGMsZSk6dD9tKHUsdCk6dm9pZCAwfWRlc3Ryb3koKXt0aGlzLnVuYmluZERhdGVwaWNrZXJFdmVudHMoKX1faGFuZGxlUmFuZ2VTdGF0dXMoKXtsZXR7cmFuZ2VEYXRlRnJvbTplLHJhbmdlRGF0ZVRvOnR9PXRoaXMuZHAsaT11KHtcIi1pbi1yYW5nZS1cIjplJiZ0JiYocz10aGlzLmRhdGUsYT1lLG49dCxtKHMsYSkmJnYocyxuKSksXCItcmFuZ2UtZnJvbS1cIjplJiZwKHRoaXMuZGF0ZSxlLHRoaXMudHlwZSksXCItcmFuZ2UtdG8tXCI6dCYmcCh0aGlzLmRhdGUsdCx0aGlzLnR5cGUpfSk7dmFyIHMsYSxuO3RoaXMuJGNlbGwuY2xhc3NMaXN0LnJlbW92ZShcIi1yYW5nZS1mcm9tLVwiLFwiLXJhbmdlLXRvLVwiLFwiLWluLXJhbmdlLVwiKSxpJiZ0aGlzLiRjZWxsLmNsYXNzTGlzdC5hZGQoLi4uaS5zcGxpdChcIiBcIikpfV9oYW5kbGVTZWxlY3RlZFN0YXR1cygpe2xldCBlPXRoaXMuZHAuX2NoZWNrSWZEYXRlSXNTZWxlY3RlZCh0aGlzLmRhdGUsdGhpcy50eXBlKTtlP3RoaXMuc2VsZWN0KCk6IWUmJnRoaXMuc2VsZWN0ZWQmJnRoaXMucmVtb3ZlU2VsZWN0KCl9X2hhbmRsZUluaXRpYWxGb2N1c1N0YXR1cygpe3AodGhpcy5kcC5mb2N1c0RhdGUsdGhpcy5kYXRlLHRoaXMudHlwZSkmJnRoaXMuZm9jdXMoKX1nZXQgaXNEaXNhYmxlZCgpe3JldHVybiB0aGlzLiRjZWxsLm1hdGNoZXMoXCIuLWRpc2FibGVkLVwiKX1nZXQgaXNPdGhlck1vbnRoKCl7cmV0dXJuIHRoaXMuZHAuaXNPdGhlck1vbnRoKHRoaXMuZGF0ZSl9Z2V0IGlzT3RoZXJEZWNhZGUoKXtyZXR1cm4gdGhpcy5kcC5pc090aGVyRGVjYWRlKHRoaXMuZGF0ZSl9fWZ1bmN0aW9uIF8oZSx0LGkpe3JldHVybih0PWZ1bmN0aW9uKGUpe3ZhciB0PWZ1bmN0aW9uKGUsdCl7aWYoXCJvYmplY3RcIiE9dHlwZW9mIGV8fG51bGw9PT1lKXJldHVybiBlO3ZhciBpPWVbU3ltYm9sLnRvUHJpbWl0aXZlXTtpZih2b2lkIDAhPT1pKXt2YXIgcz1pLmNhbGwoZSxcInN0cmluZ1wiKTtpZihcIm9iamVjdFwiIT10eXBlb2YgcylyZXR1cm4gczt0aHJvdyBuZXcgVHlwZUVycm9yKFwiQEB0b1ByaW1pdGl2ZSBtdXN0IHJldHVybiBhIHByaW1pdGl2ZSB2YWx1ZS5cIil9cmV0dXJuIFN0cmluZyhlKX0oZSk7cmV0dXJuXCJzeW1ib2xcIj09dHlwZW9mIHQ/dDpTdHJpbmcodCl9KHQpKWluIGU/T2JqZWN0LmRlZmluZVByb3BlcnR5KGUsdCx7dmFsdWU6aSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMCx3cml0YWJsZTohMH0pOmVbdF09aSxlfWxldCBNPXtbaS5kYXlzXTpgPGRpdiBjbGFzcz1cImFpci1kYXRlcGlja2VyLWJvZHktLWRheS1uYW1lc1wiPjwvZGl2PjxkaXYgY2xhc3M9XCJhaXItZGF0ZXBpY2tlci1ib2R5LS1jZWxscyAtJHtpLmRheXN9LVwiPjwvZGl2PmAsW2kubW9udGhzXTpgPGRpdiBjbGFzcz1cImFpci1kYXRlcGlja2VyLWJvZHktLWNlbGxzIC0ke2kubW9udGhzfS1cIj48L2Rpdj5gLFtpLnllYXJzXTpgPGRpdiBjbGFzcz1cImFpci1kYXRlcGlja2VyLWJvZHktLWNlbGxzIC0ke2kueWVhcnN9LVwiPjwvZGl2PmB9O2NvbnN0IFM9XCIuYWlyLWRhdGVwaWNrZXItY2VsbFwiO2NsYXNzIFR7Y29uc3RydWN0b3IoZSl7bGV0e2RwOnQsdHlwZTpzLG9wdHM6YX09ZTtfKHRoaXMsXCJoYW5kbGVDbGlja1wiLChlPT57bGV0IHQ9ZS50YXJnZXQuY2xvc2VzdChTKS5hZHBDZWxsO2lmKHQuaXNEaXNhYmxlZClyZXR1cm47aWYoIXRoaXMuZHAuaXNNaW5WaWV3UmVhY2hlZClyZXR1cm4gdm9pZCB0aGlzLmRwLmRvd24oKTtsZXQgaT10aGlzLmRwLl9jaGVja0lmRGF0ZUlzU2VsZWN0ZWQodC5kYXRlLHQudHlwZSk7aT90aGlzLmRwLl9oYW5kbGVBbHJlYWR5U2VsZWN0ZWREYXRlcyhpLHQuZGF0ZSk6dGhpcy5kcC5zZWxlY3REYXRlKHQuZGF0ZSl9KSksXyh0aGlzLFwiaGFuZGxlRGF5TmFtZUNsaWNrXCIsKGU9PntsZXQgdD1lLnRhcmdldC5nZXRBdHRyaWJ1dGUoXCJkYXRhLWRheS1pbmRleFwiKTt0aGlzLm9wdHMub25DbGlja0RheU5hbWUoe2RheUluZGV4Ok51bWJlcih0KSxkYXRlcGlja2VyOnRoaXMuZHB9KX0pKSxfKHRoaXMsXCJvbkNoYW5nZUN1cnJlbnRWaWV3XCIsKGU9PntlIT09dGhpcy50eXBlP3RoaXMuaGlkZSgpOih0aGlzLnNob3coKSx0aGlzLnJlbmRlcigpKX0pKSxfKHRoaXMsXCJvbk1vdXNlT3ZlckNlbGxcIiwoZT0+e2xldCB0PXkoZS50YXJnZXQsUyk7dGhpcy5kcC5zZXRGb2N1c0RhdGUoISF0JiZ0LmFkcENlbGwuZGF0ZSl9KSksXyh0aGlzLFwib25Nb3VzZU91dENlbGxcIiwoKCk9Pnt0aGlzLmRwLnNldEZvY3VzRGF0ZSghMSl9KSksXyh0aGlzLFwib25DbGlja0JvZHlcIiwoZT0+e2xldHtvbkNsaWNrRGF5TmFtZTp0fT10aGlzLm9wdHMsaT1lLnRhcmdldDtpLmNsb3Nlc3QoUykmJnRoaXMuaGFuZGxlQ2xpY2soZSksdCYmaS5jbG9zZXN0KFwiLmFpci1kYXRlcGlja2VyLWJvZHktLWRheS1uYW1lXCIpJiZ0aGlzLmhhbmRsZURheU5hbWVDbGljayhlKX0pKSxfKHRoaXMsXCJvbk1vdXNlRG93blwiLChlPT57dGhpcy5wcmVzc2VkPSEwO2xldCB0PXkoZS50YXJnZXQsUyksaT10JiZ0LmFkcENlbGw7cChpLmRhdGUsdGhpcy5kcC5yYW5nZURhdGVGcm9tKSYmKHRoaXMucmFuZ2VGcm9tRm9jdXNlZD0hMCkscChpLmRhdGUsdGhpcy5kcC5yYW5nZURhdGVUbykmJih0aGlzLnJhbmdlVG9Gb2N1c2VkPSEwKX0pKSxfKHRoaXMsXCJvbk1vdXNlTW92ZVwiLChlPT57aWYoIXRoaXMucHJlc3NlZHx8IXRoaXMuZHAuaXNNaW5WaWV3UmVhY2hlZClyZXR1cm47ZS5wcmV2ZW50RGVmYXVsdCgpO2xldCB0PXkoZS50YXJnZXQsUyksaT10JiZ0LmFkcENlbGwse3NlbGVjdGVkRGF0ZXM6cyxyYW5nZURhdGVUbzphLHJhbmdlRGF0ZUZyb206bn09dGhpcy5kcDtpZighaXx8aS5pc0Rpc2FibGVkKXJldHVybjtsZXR7ZGF0ZTpyfT1pO2lmKDI9PT1zLmxlbmd0aCl7aWYodGhpcy5yYW5nZUZyb21Gb2N1c2VkJiYhbShyLGEpKXtsZXR7aG91cnM6ZSxtaW51dGVzOnR9PW8obik7ci5zZXRIb3VycyhlKSxyLnNldE1pbnV0ZXModCksdGhpcy5kcC5yYW5nZURhdGVGcm9tPXIsdGhpcy5kcC5yZXBsYWNlRGF0ZShuLHIpfWlmKHRoaXMucmFuZ2VUb0ZvY3VzZWQmJiF2KHIsbikpe2xldHtob3VyczplLG1pbnV0ZXM6dH09byhhKTtyLnNldEhvdXJzKGUpLHIuc2V0TWludXRlcyh0KSx0aGlzLmRwLnJhbmdlRGF0ZVRvPXIsdGhpcy5kcC5yZXBsYWNlRGF0ZShhLHIpfX19KSksXyh0aGlzLFwib25Nb3VzZVVwXCIsKCgpPT57dGhpcy5wcmVzc2VkPSExLHRoaXMucmFuZ2VGcm9tRm9jdXNlZD0hMSx0aGlzLnJhbmdlVG9Gb2N1c2VkPSExfSkpLF8odGhpcyxcIm9uQ2hhbmdlVmlld0RhdGVcIiwoKGUsdCk9PntpZighdGhpcy5pc1Zpc2libGUpcmV0dXJuO2xldCBzPWMoZSksYT1jKHQpO3N3aXRjaCh0aGlzLmRwLmN1cnJlbnRWaWV3KXtjYXNlIGkuZGF5czppZihwKGUsdCxpLm1vbnRocykpcmV0dXJuO2JyZWFrO2Nhc2UgaS5tb250aHM6aWYocChlLHQsaS55ZWFycykpcmV0dXJuO2JyZWFrO2Nhc2UgaS55ZWFyczppZihzWzBdPT09YVswXSYmc1sxXT09PWFbMV0pcmV0dXJufXRoaXMucmVuZGVyKCl9KSksXyh0aGlzLFwicmVuZGVyXCIsKCgpPT57dGhpcy5kZXN0cm95Q2VsbHMoKSx0aGlzLl9nZW5lcmF0ZUNlbGxzKCksdGhpcy5jZWxscy5mb3JFYWNoKChlPT57dGhpcy4kY2VsbHMuYXBwZW5kQ2hpbGQoZS5yZW5kZXIoKSl9KSl9KSksdGhpcy5kcD10LHRoaXMudHlwZT1zLHRoaXMub3B0cz1hLHRoaXMuY2VsbHM9W10sdGhpcy4kZWw9XCJcIix0aGlzLnByZXNzZWQ9ITEsdGhpcy5pc1Zpc2libGU9ITAsdGhpcy5pbml0KCl9aW5pdCgpe3RoaXMuX2J1aWxkQmFzZUh0bWwoKSx0aGlzLnR5cGU9PT1pLmRheXMmJnRoaXMucmVuZGVyRGF5TmFtZXMoKSx0aGlzLnJlbmRlcigpLHRoaXMuX2JpbmRFdmVudHMoKSx0aGlzLl9iaW5kRGF0ZXBpY2tlckV2ZW50cygpfV9iaW5kRXZlbnRzKCl7bGV0e3JhbmdlOmUsZHluYW1pY1JhbmdlOnR9PXRoaXMub3B0cztEKHRoaXMuJGVsLFwibW91c2VvdmVyXCIsdGhpcy5vbk1vdXNlT3ZlckNlbGwpLEQodGhpcy4kZWwsXCJtb3VzZW91dFwiLHRoaXMub25Nb3VzZU91dENlbGwpLEQodGhpcy4kZWwsXCJjbGlja1wiLHRoaXMub25DbGlja0JvZHkpLGUmJnQmJihEKHRoaXMuJGVsLFwibW91c2Vkb3duXCIsdGhpcy5vbk1vdXNlRG93biksRCh0aGlzLiRlbCxcIm1vdXNlbW92ZVwiLHRoaXMub25Nb3VzZU1vdmUpLEQod2luZG93LmRvY3VtZW50LFwibW91c2V1cFwiLHRoaXMub25Nb3VzZVVwKSl9X2JpbmREYXRlcGlja2VyRXZlbnRzKCl7dGhpcy5kcC5vbihpLmV2ZW50Q2hhbmdlVmlld0RhdGUsdGhpcy5vbkNoYW5nZVZpZXdEYXRlKSx0aGlzLmRwLm9uKGkuZXZlbnRDaGFuZ2VDdXJyZW50Vmlldyx0aGlzLm9uQ2hhbmdlQ3VycmVudFZpZXcpfV9idWlsZEJhc2VIdG1sKCl7dGhpcy4kZWw9bih7Y2xhc3NOYW1lOmBhaXItZGF0ZXBpY2tlci1ib2R5IC0ke3RoaXMudHlwZX0tYCxpbm5lckh0bWw6TVt0aGlzLnR5cGVdfSksdGhpcy4kbmFtZXM9YShcIi5haXItZGF0ZXBpY2tlci1ib2R5LS1kYXktbmFtZXNcIix0aGlzLiRlbCksdGhpcy4kY2VsbHM9YShcIi5haXItZGF0ZXBpY2tlci1ib2R5LS1jZWxsc1wiLHRoaXMuJGVsKX1fZ2V0RGF5TmFtZXNIdG1sKCl7bGV0IGU9YXJndW1lbnRzLmxlbmd0aD4wJiZ2b2lkIDAhPT1hcmd1bWVudHNbMF0/YXJndW1lbnRzWzBdOnRoaXMuZHAubG9jYWxlLmZpcnN0RGF5LHQ9XCJcIixzPXRoaXMuZHAuaXNXZWVrZW5kLHtvbkNsaWNrRGF5TmFtZTphfT10aGlzLm9wdHMsbj1lLHI9MDtmb3IoO3I8Nzspe2xldCBlPW4lNzt0Kz1gPGRpdiBjbGFzcz1cIiR7dShcImFpci1kYXRlcGlja2VyLWJvZHktLWRheS1uYW1lXCIse1tpLmNzc0NsYXNzV2Vla2VuZF06cyhlKSxcIi1jbGlja2FibGUtXCI6ISFhfSl9XCIgZGF0YS1kYXktaW5kZXg9JyR7ZX0nPiR7dGhpcy5kcC5sb2NhbGUuZGF5c01pbltlXX08L2Rpdj5gLHIrKyxuKyt9cmV0dXJuIHR9cmVuZGVyRGF5TmFtZXMoKXt0aGlzLiRuYW1lcy5pbm5lckhUTUw9dGhpcy5fZ2V0RGF5TmFtZXNIdG1sKCl9X2dlbmVyYXRlQ2VsbChlKXtsZXR7dHlwZTp0LGRwOmksb3B0czpzfT10aGlzO3JldHVybiBuZXcgQyh7dHlwZTp0LGRwOmksb3B0czpzLGRhdGU6ZSxib2R5OnRoaXN9KX1fZ2VuZXJhdGVDZWxscygpe1QuZ2V0RGF0ZXNGdW5jdGlvbih0aGlzLnR5cGUpKHRoaXMuZHAsKGU9Pnt0aGlzLmNlbGxzLnB1c2godGhpcy5fZ2VuZXJhdGVDZWxsKGUpKX0pKX1zaG93KCl7dGhpcy5pc1Zpc2libGU9ITAsdGhpcy4kZWwuY2xhc3NMaXN0LnJlbW92ZShcIi1oaWRkZW4tXCIpfWhpZGUoKXt0aGlzLmlzVmlzaWJsZT0hMSx0aGlzLiRlbC5jbGFzc0xpc3QuYWRkKFwiLWhpZGRlbi1cIil9ZGVzdHJveUNlbGxzKCl7dGhpcy5jZWxscy5mb3JFYWNoKChlPT5lLmRlc3Ryb3koKSkpLHRoaXMuY2VsbHM9W10sdGhpcy4kY2VsbHMuaW5uZXJIVE1MPVwiXCJ9ZGVzdHJveSgpe3RoaXMuZGVzdHJveUNlbGxzKCksdGhpcy5kcC5vZmYoaS5ldmVudENoYW5nZVZpZXdEYXRlLHRoaXMub25DaGFuZ2VWaWV3RGF0ZSksdGhpcy5kcC5vZmYoaS5ldmVudENoYW5nZUN1cnJlbnRWaWV3LHRoaXMub25DaGFuZ2VDdXJyZW50Vmlldyl9c3RhdGljIGdldERheXNEYXRlcyhlLHQpe2xldHt2aWV3RGF0ZTppLGxvY2FsZTp7Zmlyc3REYXk6c319PWUsYT1oKGkpLHt5ZWFyOm4sbW9udGg6cn09byhpKSxsPW5ldyBEYXRlKG4sciwxKSxkPW5ldyBEYXRlKG4scixhKSxjPWwuZ2V0RGF5KCktcyx1PTYtZC5nZXREYXkoKStzO2M9YzwwP2MrNzpjLHU9dT42P3UtNzp1O2xldCBwPWZ1bmN0aW9uKGUsdCl7bGV0e3llYXI6aSxtb250aDpzLGRhdGU6YX09byhlKTtyZXR1cm4gbmV3IERhdGUoaSxzLGEtdCl9KGwsYyksbT1hK2MrdSx2PXAuZ2V0RGF0ZSgpLHt5ZWFyOmcsbW9udGg6RH09byhwKSx5PTA7Y29uc3QgZj1bXTtmb3IoO3k8bTspe2xldCBlPW5ldyBEYXRlKGcsRCx2K3kpO3QmJnQoZSksZi5wdXNoKGUpLHkrK31yZXR1cm4gZn1zdGF0aWMgZ2V0TW9udGhzRGF0ZXMoZSx0KXtsZXR7eWVhcjppfT1lLnBhcnNlZFZpZXdEYXRlLHM9MCxhPVtdO2Zvcig7czwxMjspe2NvbnN0IGU9bmV3IERhdGUoaSxzKTthLnB1c2goZSksdCYmdChlKSxzKyt9cmV0dXJuIGF9c3RhdGljIGdldFllYXJzRGF0ZXMoZSx0KXtsZXQgaT1jKGUudmlld0RhdGUpLHM9aVswXS0xLGE9aVsxXSsxLG49cyxyPVtdO2Zvcig7bjw9YTspe2NvbnN0IGU9bmV3IERhdGUobiwwKTtyLnB1c2goZSksdCYmdChlKSxuKyt9cmV0dXJuIHJ9c3RhdGljIGdldERhdGVzRnVuY3Rpb24oKXtsZXQgZT1hcmd1bWVudHMubGVuZ3RoPjAmJnZvaWQgMCE9PWFyZ3VtZW50c1swXT9hcmd1bWVudHNbMF06aS5kYXlzO3JldHVybntbaS5kYXlzXTpULmdldERheXNEYXRlcyxbaS5tb250aHNdOlQuZ2V0TW9udGhzRGF0ZXMsW2kueWVhcnNdOlQuZ2V0WWVhcnNEYXRlc31bZV19fWZ1bmN0aW9uIEYoZSx0LGkpe3JldHVybih0PWZ1bmN0aW9uKGUpe3ZhciB0PWZ1bmN0aW9uKGUsdCl7aWYoXCJvYmplY3RcIiE9dHlwZW9mIGV8fG51bGw9PT1lKXJldHVybiBlO3ZhciBpPWVbU3ltYm9sLnRvUHJpbWl0aXZlXTtpZih2b2lkIDAhPT1pKXt2YXIgcz1pLmNhbGwoZSxcInN0cmluZ1wiKTtpZihcIm9iamVjdFwiIT10eXBlb2YgcylyZXR1cm4gczt0aHJvdyBuZXcgVHlwZUVycm9yKFwiQEB0b1ByaW1pdGl2ZSBtdXN0IHJldHVybiBhIHByaW1pdGl2ZSB2YWx1ZS5cIil9cmV0dXJuIFN0cmluZyhlKX0oZSk7cmV0dXJuXCJzeW1ib2xcIj09dHlwZW9mIHQ/dDpTdHJpbmcodCl9KHQpKWluIGU/T2JqZWN0LmRlZmluZVByb3BlcnR5KGUsdCx7dmFsdWU6aSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMCx3cml0YWJsZTohMH0pOmVbdF09aSxlfWNsYXNzIFZ7Y29uc3RydWN0b3IoZSl7bGV0e2RwOnQsb3B0czppfT1lO0YodGhpcyxcIm9uQ2xpY2tOYXZcIiwoZT0+e2xldCB0PXkoZS50YXJnZXQsXCIuYWlyLWRhdGVwaWNrZXItbmF2LS1hY3Rpb25cIik7aWYoIXQpcmV0dXJuO2xldCBpPXQuZGF0YXNldC5hY3Rpb247dGhpcy5kcFtpXSgpfSkpLEYodGhpcyxcIm9uQ2hhbmdlVmlld0RhdGVcIiwoKCk9Pnt0aGlzLnJlbmRlcigpLHRoaXMuX3Jlc2V0TmF2U3RhdHVzKCksdGhpcy5oYW5kbGVOYXZTdGF0dXMoKX0pKSxGKHRoaXMsXCJvbkNoYW5nZUN1cnJlbnRWaWV3XCIsKCgpPT57dGhpcy5yZW5kZXIoKSx0aGlzLl9yZXNldE5hdlN0YXR1cygpLHRoaXMuaGFuZGxlTmF2U3RhdHVzKCl9KSksRih0aGlzLFwib25DbGlja05hdlRpdGxlXCIsKCgpPT57dGhpcy5kcC5pc0ZpbmFsVmlld3x8dGhpcy5kcC51cCgpfSkpLEYodGhpcyxcInVwZGF0ZVwiLCgoKT0+e2xldHtwcmV2SHRtbDplLG5leHRIdG1sOnR9PXRoaXMub3B0czt0aGlzLiRwcmV2LmlubmVySFRNTD1lLHRoaXMuJG5leHQuaW5uZXJIVE1MPXQsdGhpcy5fcmVzZXROYXZTdGF0dXMoKSx0aGlzLnJlbmRlcigpLHRoaXMuaGFuZGxlTmF2U3RhdHVzKCl9KSksRih0aGlzLFwicmVuZGVyRGVsYXlcIiwoKCk9PntzZXRUaW1lb3V0KHRoaXMucmVuZGVyKX0pKSxGKHRoaXMsXCJyZW5kZXJcIiwoKCk9Pnt0aGlzLiR0aXRsZS5pbm5lckhUTUw9dGhpcy5fZ2V0VGl0bGUoKSxmdW5jdGlvbihlLHQpe2ZvcihsZXQgaSBpbiB0KXRbaV0/ZS5jbGFzc0xpc3QuYWRkKGkpOmUuY2xhc3NMaXN0LnJlbW92ZShpKX0odGhpcy4kdGl0bGUse1wiLWRpc2FibGVkLVwiOnRoaXMuZHAuaXNGaW5hbFZpZXd9KX0pKSx0aGlzLmRwPXQsdGhpcy5vcHRzPWksdGhpcy5pbml0KCl9aW5pdCgpe3RoaXMuX2NyZWF0ZUVsZW1lbnQoKSx0aGlzLl9idWlsZEJhc2VIdG1sKCksdGhpcy5fZGVmaW5lRE9NKCksdGhpcy5yZW5kZXIoKSx0aGlzLmhhbmRsZU5hdlN0YXR1cygpLHRoaXMuX2JpbmRFdmVudHMoKSx0aGlzLl9iaW5kRGF0ZXBpY2tlckV2ZW50cygpfV9kZWZpbmVET00oKXt0aGlzLiR0aXRsZT1hKFwiLmFpci1kYXRlcGlja2VyLW5hdi0tdGl0bGVcIix0aGlzLiRlbCksdGhpcy4kcHJldj1hKCdbZGF0YS1hY3Rpb249XCJwcmV2XCJdJyx0aGlzLiRlbCksdGhpcy4kbmV4dD1hKCdbZGF0YS1hY3Rpb249XCJuZXh0XCJdJyx0aGlzLiRlbCl9X2JpbmRFdmVudHMoKXt0aGlzLiRlbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIix0aGlzLm9uQ2xpY2tOYXYpLHRoaXMuJHRpdGxlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLHRoaXMub25DbGlja05hdlRpdGxlKX1fYmluZERhdGVwaWNrZXJFdmVudHMoKXt0aGlzLmRwLm9uKGkuZXZlbnRDaGFuZ2VWaWV3RGF0ZSx0aGlzLm9uQ2hhbmdlVmlld0RhdGUpLHRoaXMuZHAub24oaS5ldmVudENoYW5nZUN1cnJlbnRWaWV3LHRoaXMub25DaGFuZ2VDdXJyZW50VmlldyksdGhpcy5pc05hdklzRnVuY3Rpb24mJih0aGlzLmRwLm9uKGkuZXZlbnRDaGFuZ2VTZWxlY3RlZERhdGUsdGhpcy5yZW5kZXJEZWxheSksdGhpcy5kcC5vcHRzLnRpbWVwaWNrZXImJnRoaXMuZHAub24oaS5ldmVudENoYW5nZVRpbWUsdGhpcy5yZW5kZXIpKX1kZXN0cm95KCl7dGhpcy5kcC5vZmYoaS5ldmVudENoYW5nZVZpZXdEYXRlLHRoaXMub25DaGFuZ2VWaWV3RGF0ZSksdGhpcy5kcC5vZmYoaS5ldmVudENoYW5nZUN1cnJlbnRWaWV3LHRoaXMub25DaGFuZ2VDdXJyZW50VmlldyksdGhpcy5pc05hdklzRnVuY3Rpb24mJih0aGlzLmRwLm9mZihpLmV2ZW50Q2hhbmdlU2VsZWN0ZWREYXRlLHRoaXMucmVuZGVyRGVsYXkpLHRoaXMuZHAub3B0cy50aW1lcGlja2VyJiZ0aGlzLmRwLm9mZihpLmV2ZW50Q2hhbmdlVGltZSx0aGlzLnJlbmRlcikpfV9jcmVhdGVFbGVtZW50KCl7dGhpcy4kZWw9bih7dGFnTmFtZTpcIm5hdlwiLGNsYXNzTmFtZTpcImFpci1kYXRlcGlja2VyLW5hdlwifSl9X2dldFRpdGxlKCl7bGV0e2RwOmUsb3B0czp0fT10aGlzLGk9dC5uYXZUaXRsZXNbZS5jdXJyZW50Vmlld107cmV0dXJuXCJmdW5jdGlvblwiPT10eXBlb2YgaT9pKGUpOmUuZm9ybWF0RGF0ZShlLnZpZXdEYXRlLGkpfWhhbmRsZU5hdlN0YXR1cygpe2xldHtkaXNhYmxlTmF2V2hlbk91dE9mUmFuZ2U6ZX09dGhpcy5vcHRzLHttaW5EYXRlOnQsbWF4RGF0ZTpzfT10aGlzLmRwO2lmKCF0JiYhc3x8IWUpcmV0dXJuO2xldHt5ZWFyOmEsbW9udGg6bn09dGhpcy5kcC5wYXJzZWRWaWV3RGF0ZSxyPSEhdCYmbyh0KSxoPSEhcyYmbyhzKTtzd2l0Y2godGhpcy5kcC5jdXJyZW50Vmlldyl7Y2FzZSBpLmRheXM6dCYmci5tb250aD49biYmci55ZWFyPj1hJiZ0aGlzLl9kaXNhYmxlTmF2KFwicHJldlwiKSxzJiZoLm1vbnRoPD1uJiZoLnllYXI8PWEmJnRoaXMuX2Rpc2FibGVOYXYoXCJuZXh0XCIpO2JyZWFrO2Nhc2UgaS5tb250aHM6dCYmci55ZWFyPj1hJiZ0aGlzLl9kaXNhYmxlTmF2KFwicHJldlwiKSxzJiZoLnllYXI8PWEmJnRoaXMuX2Rpc2FibGVOYXYoXCJuZXh0XCIpO2JyZWFrO2Nhc2UgaS55ZWFyczp7bGV0IGU9Yyh0aGlzLmRwLnZpZXdEYXRlKTt0JiZyLnllYXI+PWVbMF0mJnRoaXMuX2Rpc2FibGVOYXYoXCJwcmV2XCIpLHMmJmgueWVhcjw9ZVsxXSYmdGhpcy5fZGlzYWJsZU5hdihcIm5leHRcIik7YnJlYWt9fX1fZGlzYWJsZU5hdihlKXthKCdbZGF0YS1hY3Rpb249XCInK2UrJ1wiXScsdGhpcy4kZWwpLmNsYXNzTGlzdC5hZGQoXCItZGlzYWJsZWQtXCIpfV9yZXNldE5hdlN0YXR1cygpeyFmdW5jdGlvbihlKXtmb3IodmFyIHQ9YXJndW1lbnRzLmxlbmd0aCxpPW5ldyBBcnJheSh0PjE/dC0xOjApLHM9MTtzPHQ7cysrKWlbcy0xXT1hcmd1bWVudHNbc107ZS5sZW5ndGg/ZS5mb3JFYWNoKChlPT57ZS5jbGFzc0xpc3QucmVtb3ZlKC4uLmkpfSkpOmUuY2xhc3NMaXN0LnJlbW92ZSguLi5pKX0odGhpcy4kZWwucXVlcnlTZWxlY3RvckFsbChcIi5haXItZGF0ZXBpY2tlci1uYXYtLWFjdGlvblwiKSxcIi1kaXNhYmxlZC1cIil9X2J1aWxkQmFzZUh0bWwoKXtsZXR7cHJldkh0bWw6ZSxuZXh0SHRtbDp0fT10aGlzLm9wdHM7dGhpcy4kZWwuaW5uZXJIVE1MPWA8ZGl2IGNsYXNzPVwiYWlyLWRhdGVwaWNrZXItbmF2LS1hY3Rpb25cIiBkYXRhLWFjdGlvbj1cInByZXZcIj4ke2V9PC9kaXY+PGRpdiBjbGFzcz1cImFpci1kYXRlcGlja2VyLW5hdi0tdGl0bGVcIj48L2Rpdj48ZGl2IGNsYXNzPVwiYWlyLWRhdGVwaWNrZXItbmF2LS1hY3Rpb25cIiBkYXRhLWFjdGlvbj1cIm5leHRcIj4ke3R9PC9kaXY+YH1nZXQgaXNOYXZJc0Z1bmN0aW9uKCl7bGV0e25hdlRpdGxlczplfT10aGlzLm9wdHM7cmV0dXJuIE9iamVjdC5rZXlzKGUpLmZpbmQoKHQ9PlwiZnVuY3Rpb25cIj09dHlwZW9mIGVbdF0pKX19dmFyIHg9e3RvZGF5Ontjb250ZW50OmU9PmUubG9jYWxlLnRvZGF5LG9uQ2xpY2s6ZT0+ZS5zZXRWaWV3RGF0ZShuZXcgRGF0ZSl9LGNsZWFyOntjb250ZW50OmU9PmUubG9jYWxlLmNsZWFyLG9uQ2xpY2s6ZT0+ZS5jbGVhcigpfX07Y2xhc3MgSHtjb25zdHJ1Y3RvcihlKXtsZXR7ZHA6dCxvcHRzOml9PWU7dGhpcy5kcD10LHRoaXMub3B0cz1pLHRoaXMuaW5pdCgpfWluaXQoKXt0aGlzLmNyZWF0ZUVsZW1lbnQoKSx0aGlzLnJlbmRlcigpfWNyZWF0ZUVsZW1lbnQoKXt0aGlzLiRlbD1uKHtjbGFzc05hbWU6XCJhaXItZGF0ZXBpY2tlci1idXR0b25zXCJ9KX1kZXN0cm95KCl7dGhpcy4kZWwucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLiRlbCl9Y2xlYXJIdG1sKCl7cmV0dXJuIHRoaXMuJGVsLmlubmVySFRNTD1cIlwiLHRoaXN9Z2VuZXJhdGVCdXR0b25zKCl7bGV0e2J1dHRvbnM6ZX09dGhpcy5vcHRzO0FycmF5LmlzQXJyYXkoZSl8fChlPVtlXSksZS5mb3JFYWNoKChlPT57bGV0IHQ9ZTtcInN0cmluZ1wiPT10eXBlb2YgZSYmeFtlXSYmKHQ9eFtlXSk7bGV0IGk9dGhpcy5jcmVhdGVCdXR0b24odCk7dC5vbkNsaWNrJiZ0aGlzLmF0dGFjaEV2ZW50VG9CdXR0b24oaSx0Lm9uQ2xpY2spLHRoaXMuJGVsLmFwcGVuZENoaWxkKGkpfSkpfWF0dGFjaEV2ZW50VG9CdXR0b24oZSx0KXtlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCgoKT0+e3QodGhpcy5kcCl9KSl9Y3JlYXRlQnV0dG9uKGUpe2xldHtjb250ZW50OnQsY2xhc3NOYW1lOmksdGFnTmFtZTpzPVwiYnV0dG9uXCIsYXR0cnM6YT17fX09ZTtyZXR1cm4gbih7dGFnTmFtZTpzLGlubmVySHRtbDpgPHNwYW4gdGFiaW5kZXg9Jy0xJz4ke1wiZnVuY3Rpb25cIj09dHlwZW9mIHQ/dCh0aGlzLmRwKTp0fTwvc3Bhbj5gLGNsYXNzTmFtZTp1KFwiYWlyLWRhdGVwaWNrZXItYnV0dG9uXCIsaSksYXR0cnM6YX0pfXJlbmRlcigpe3RoaXMuZ2VuZXJhdGVCdXR0b25zKCl9fWZ1bmN0aW9uIEUoZSx0LGkpe3JldHVybih0PWZ1bmN0aW9uKGUpe3ZhciB0PWZ1bmN0aW9uKGUsdCl7aWYoXCJvYmplY3RcIiE9dHlwZW9mIGV8fG51bGw9PT1lKXJldHVybiBlO3ZhciBpPWVbU3ltYm9sLnRvUHJpbWl0aXZlXTtpZih2b2lkIDAhPT1pKXt2YXIgcz1pLmNhbGwoZSxcInN0cmluZ1wiKTtpZihcIm9iamVjdFwiIT10eXBlb2YgcylyZXR1cm4gczt0aHJvdyBuZXcgVHlwZUVycm9yKFwiQEB0b1ByaW1pdGl2ZSBtdXN0IHJldHVybiBhIHByaW1pdGl2ZSB2YWx1ZS5cIil9cmV0dXJuIFN0cmluZyhlKX0oZSk7cmV0dXJuXCJzeW1ib2xcIj09dHlwZW9mIHQ/dDpTdHJpbmcodCl9KHQpKWluIGU/T2JqZWN0LmRlZmluZVByb3BlcnR5KGUsdCx7dmFsdWU6aSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMCx3cml0YWJsZTohMH0pOmVbdF09aSxlfWNsYXNzIEx7Y29uc3RydWN0b3IoKXtsZXR7b3B0czplLGRwOnR9PWFyZ3VtZW50cy5sZW5ndGg+MCYmdm9pZCAwIT09YXJndW1lbnRzWzBdP2FyZ3VtZW50c1swXTp7fTtFKHRoaXMsXCJ0b2dnbGVUaW1lcGlja2VySXNBY3RpdmVcIiwoZT0+e3RoaXMuZHAudGltZXBpY2tlcklzQWN0aXZlPWV9KSksRSh0aGlzLFwib25DaGFuZ2VTZWxlY3RlZERhdGVcIiwoZT0+e2xldHtkYXRlOnQsdXBkYXRlVGltZTppPSExfT1lO3QmJih0aGlzLnNldE1pbk1heFRpbWUodCksdGhpcy5zZXRDdXJyZW50VGltZSghIWkmJnQpLHRoaXMuYWRkVGltZVRvRGF0ZSh0KSl9KSksRSh0aGlzLFwib25DaGFuZ2VMYXN0U2VsZWN0ZWREYXRlXCIsKGU9PntlJiYodGhpcy5zZXRUaW1lKGUpLHRoaXMucmVuZGVyKCkpfSkpLEUodGhpcyxcIm9uQ2hhbmdlSW5wdXRSYW5nZVwiLChlPT57bGV0IHQ9ZS50YXJnZXQ7dGhpc1t0LmdldEF0dHJpYnV0ZShcIm5hbWVcIildPXQudmFsdWUsdGhpcy51cGRhdGVUZXh0KCksdGhpcy5kcC50cmlnZ2VyKGkuZXZlbnRDaGFuZ2VUaW1lLHtob3Vyczp0aGlzLmhvdXJzLG1pbnV0ZXM6dGhpcy5taW51dGVzfSl9KSksRSh0aGlzLFwib25Nb3VzZUVudGVyTGVhdmVcIiwoZT0+e2xldCB0PWUudGFyZ2V0LmdldEF0dHJpYnV0ZShcIm5hbWVcIiksaT10aGlzLiRtaW51dGVzVGV4dDtcImhvdXJzXCI9PT10JiYoaT10aGlzLiRob3Vyc1RleHQpLGkuY2xhc3NMaXN0LnRvZ2dsZShcIi1mb2N1cy1cIil9KSksRSh0aGlzLFwib25Gb2N1c1wiLCgoKT0+e3RoaXMudG9nZ2xlVGltZXBpY2tlcklzQWN0aXZlKCEwKX0pKSxFKHRoaXMsXCJvbkJsdXJcIiwoKCk9Pnt0aGlzLnRvZ2dsZVRpbWVwaWNrZXJJc0FjdGl2ZSghMSl9KSksdGhpcy5vcHRzPWUsdGhpcy5kcD10O2xldHt0aW1lRm9ybWF0OnN9PXRoaXMuZHAubG9jYWxlO3MmJihzLm1hdGNoKGsoXCJoXCIpKXx8cy5tYXRjaChrKFwiaGhcIikpKSYmKHRoaXMuYW1wbT0hMCksdGhpcy5pbml0KCl9aW5pdCgpe3RoaXMuc2V0VGltZSh0aGlzLmRwLmxhc3RTZWxlY3RlZERhdGV8fHRoaXMuZHAudmlld0RhdGUpLHRoaXMuY3JlYXRlRWxlbWVudCgpLHRoaXMuYnVpbGRIdG1sKCksdGhpcy5kZWZpbmVET00oKSx0aGlzLnJlbmRlcigpLHRoaXMuYmluZERhdGVwaWNrZXJFdmVudHMoKSx0aGlzLmJpbmRET01FdmVudHMoKX1iaW5kRGF0ZXBpY2tlckV2ZW50cygpe3RoaXMuZHAub24oaS5ldmVudENoYW5nZVNlbGVjdGVkRGF0ZSx0aGlzLm9uQ2hhbmdlU2VsZWN0ZWREYXRlKSx0aGlzLmRwLm9uKGkuZXZlbnRDaGFuZ2VMYXN0U2VsZWN0ZWREYXRlLHRoaXMub25DaGFuZ2VMYXN0U2VsZWN0ZWREYXRlKX1iaW5kRE9NRXZlbnRzKCl7bGV0IGU9XCJpbnB1dFwiO25hdmlnYXRvci51c2VyQWdlbnQubWF0Y2goL3RyaWRlbnQvZ2kpJiYoZT1cImNoYW5nZVwiKSxEKHRoaXMuJHJhbmdlcyxlLHRoaXMub25DaGFuZ2VJbnB1dFJhbmdlKSxEKHRoaXMuJHJhbmdlcyxcIm1vdXNlZW50ZXJcIix0aGlzLm9uTW91c2VFbnRlckxlYXZlKSxEKHRoaXMuJHJhbmdlcyxcIm1vdXNlbGVhdmVcIix0aGlzLm9uTW91c2VFbnRlckxlYXZlKSxEKHRoaXMuJHJhbmdlcyxcImZvY3VzXCIsdGhpcy5vbkZvY3VzKSxEKHRoaXMuJHJhbmdlcyxcIm1vdXNlZG93blwiLHRoaXMub25Gb2N1cyksRCh0aGlzLiRyYW5nZXMsXCJibHVyXCIsdGhpcy5vbkJsdXIpfWNyZWF0ZUVsZW1lbnQoKXt0aGlzLiRlbD1uKHtjbGFzc05hbWU6dShcImFpci1kYXRlcGlja2VyLXRpbWVcIix7XCItYW0tcG0tXCI6dGhpcy5kcC5hbXBtfSl9KX1kZXN0cm95KCl7dGhpcy5kcC5vZmYoaS5ldmVudENoYW5nZVNlbGVjdGVkRGF0ZSx0aGlzLm9uQ2hhbmdlU2VsZWN0ZWREYXRlKSx0aGlzLmRwLm9mZihpLmV2ZW50Q2hhbmdlTGFzdFNlbGVjdGVkRGF0ZSx0aGlzLm9uQ2hhbmdlTGFzdFNlbGVjdGVkRGF0ZSksdGhpcy4kZWwucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLiRlbCl9YnVpbGRIdG1sKCl7bGV0e2FtcG06ZSxob3Vyczp0LGRpc3BsYXlIb3VyczppLG1pbnV0ZXM6cyxtaW5Ib3VyczphLG1pbk1pbnV0ZXM6bixtYXhIb3VyczpyLG1heE1pbnV0ZXM6aCxkYXlQZXJpb2Q6byxvcHRzOntob3Vyc1N0ZXA6bCxtaW51dGVzU3RlcDpjfX09dGhpczt0aGlzLiRlbC5pbm5lckhUTUw9YDxkaXYgY2xhc3M9XCJhaXItZGF0ZXBpY2tlci10aW1lLS1jdXJyZW50XCI+ICAgPHNwYW4gY2xhc3M9XCJhaXItZGF0ZXBpY2tlci10aW1lLS1jdXJyZW50LWhvdXJzXCI+JHtkKGkpfTwvc3Bhbj4gICA8c3BhbiBjbGFzcz1cImFpci1kYXRlcGlja2VyLXRpbWUtLWN1cnJlbnQtY29sb25cIj46PC9zcGFuPiAgIDxzcGFuIGNsYXNzPVwiYWlyLWRhdGVwaWNrZXItdGltZS0tY3VycmVudC1taW51dGVzXCI+JHtkKHMpfTwvc3Bhbj4gICBgKyhlP2A8c3BhbiBjbGFzcz0nYWlyLWRhdGVwaWNrZXItdGltZS0tY3VycmVudC1hbXBtJz4ke299PC9zcGFuPmA6XCJcIikrJzwvZGl2PjxkaXYgY2xhc3M9XCJhaXItZGF0ZXBpY2tlci10aW1lLS1zbGlkZXJzXCI+ICAgPGRpdiBjbGFzcz1cImFpci1kYXRlcGlja2VyLXRpbWUtLXJvd1wiPicrYCAgICAgIDxpbnB1dCB0eXBlPVwicmFuZ2VcIiBuYW1lPVwiaG91cnNcIiB2YWx1ZT1cIiR7dH1cIiBtaW49XCIke2F9XCIgbWF4PVwiJHtyfVwiIHN0ZXA9XCIke2x9XCIvPiAgIDwvZGl2PiAgIDxkaXYgY2xhc3M9XCJhaXItZGF0ZXBpY2tlci10aW1lLS1yb3dcIj5gK2AgICAgICA8aW5wdXQgdHlwZT1cInJhbmdlXCIgbmFtZT1cIm1pbnV0ZXNcIiB2YWx1ZT1cIiR7c31cIiBtaW49XCIke259XCIgbWF4PVwiJHtofVwiIHN0ZXA9XCIke2N9XCIvPiAgIDwvZGl2PjwvZGl2PmB9ZGVmaW5lRE9NKCl7bGV0IGU9ZT0+YShlLHRoaXMuJGVsKTt0aGlzLiRyYW5nZXM9dGhpcy4kZWwucXVlcnlTZWxlY3RvckFsbCgnW3R5cGU9XCJyYW5nZVwiXScpLHRoaXMuJGhvdXJzPWUoJ1tuYW1lPVwiaG91cnNcIl0nKSx0aGlzLiRtaW51dGVzPWUoJ1tuYW1lPVwibWludXRlc1wiXScpLHRoaXMuJGhvdXJzVGV4dD1lKFwiLmFpci1kYXRlcGlja2VyLXRpbWUtLWN1cnJlbnQtaG91cnNcIiksdGhpcy4kbWludXRlc1RleHQ9ZShcIi5haXItZGF0ZXBpY2tlci10aW1lLS1jdXJyZW50LW1pbnV0ZXNcIiksdGhpcy4kYW1wbT1lKFwiLmFpci1kYXRlcGlja2VyLXRpbWUtLWN1cnJlbnQtYW1wbVwiKX1zZXRUaW1lKGUpe3RoaXMuc2V0TWluTWF4VGltZShlKSx0aGlzLnNldEN1cnJlbnRUaW1lKGUpfWFkZFRpbWVUb0RhdGUoZSl7ZSYmKGUuc2V0SG91cnModGhpcy5ob3VycyksZS5zZXRNaW51dGVzKHRoaXMubWludXRlcykpfXNldE1pbk1heFRpbWUoZSl7aWYodGhpcy5zZXRNaW5NYXhUaW1lRnJvbU9wdGlvbnMoKSxlKXtsZXR7bWluRGF0ZTp0LG1heERhdGU6aX09dGhpcy5kcDt0JiZwKGUsdCkmJnRoaXMuc2V0TWluVGltZUZyb21NaW5EYXRlKHQpLGkmJnAoZSxpKSYmdGhpcy5zZXRNYXhUaW1lRnJvbU1heERhdGUoaSl9fXNldEN1cnJlbnRUaW1lKGUpe2xldHtob3Vyczp0LG1pbnV0ZXM6aX09ZT9vKGUpOnRoaXM7dGhpcy5ob3Vycz1mKHQsdGhpcy5taW5Ib3Vycyx0aGlzLm1heEhvdXJzKSx0aGlzLm1pbnV0ZXM9ZihpLHRoaXMubWluTWludXRlcyx0aGlzLm1heE1pbnV0ZXMpfXNldE1pbk1heFRpbWVGcm9tT3B0aW9ucygpe2xldHttaW5Ib3VyczplLG1pbk1pbnV0ZXM6dCxtYXhIb3VyczppLG1heE1pbnV0ZXM6c309dGhpcy5vcHRzO3RoaXMubWluSG91cnM9ZihlLDAsMjMpLHRoaXMubWluTWludXRlcz1mKHQsMCw1OSksdGhpcy5tYXhIb3Vycz1mKGksMCwyMyksdGhpcy5tYXhNaW51dGVzPWYocywwLDU5KX1zZXRNaW5UaW1lRnJvbU1pbkRhdGUoZSl7bGV0e2xhc3RTZWxlY3RlZERhdGU6dH09dGhpcy5kcDt0aGlzLm1pbkhvdXJzPWUuZ2V0SG91cnMoKSx0JiZ0LmdldEhvdXJzKCk+ZS5nZXRIb3VycygpP3RoaXMubWluTWludXRlcz10aGlzLm9wdHMubWluTWludXRlczp0aGlzLm1pbk1pbnV0ZXM9ZS5nZXRNaW51dGVzKCl9c2V0TWF4VGltZUZyb21NYXhEYXRlKGUpe2xldHtsYXN0U2VsZWN0ZWREYXRlOnR9PXRoaXMuZHA7dGhpcy5tYXhIb3Vycz1lLmdldEhvdXJzKCksdCYmdC5nZXRIb3VycygpPGUuZ2V0SG91cnMoKT90aGlzLm1heE1pbnV0ZXM9dGhpcy5vcHRzLm1heE1pbnV0ZXM6dGhpcy5tYXhNaW51dGVzPWUuZ2V0TWludXRlcygpfXVwZGF0ZVNsaWRlcnMoKXtyKHRoaXMuJGhvdXJzLHttaW46dGhpcy5taW5Ib3VycyxtYXg6dGhpcy5tYXhIb3Vyc30pLnZhbHVlPXRoaXMuaG91cnMscih0aGlzLiRtaW51dGVzLHttaW46dGhpcy5taW5NaW51dGVzLG1heDp0aGlzLm1heE1pbnV0ZXN9KS52YWx1ZT10aGlzLm1pbnV0ZXN9dXBkYXRlVGV4dCgpe3RoaXMuJGhvdXJzVGV4dC5pbm5lckhUTUw9ZCh0aGlzLmRpc3BsYXlIb3VycyksdGhpcy4kbWludXRlc1RleHQuaW5uZXJIVE1MPWQodGhpcy5taW51dGVzKSx0aGlzLmFtcG0mJih0aGlzLiRhbXBtLmlubmVySFRNTD10aGlzLmRheVBlcmlvZCl9c2V0IGhvdXJzKGUpe3RoaXMuX2hvdXJzPWU7bGV0e2hvdXJzOnQsZGF5UGVyaW9kOml9PWwoZSk7dGhpcy5kaXNwbGF5SG91cnM9dGhpcy5hbXBtP3Q6ZSx0aGlzLmRheVBlcmlvZD1pfWdldCBob3Vycygpe3JldHVybiB0aGlzLl9ob3Vyc31yZW5kZXIoKXt0aGlzLnVwZGF0ZVNsaWRlcnMoKSx0aGlzLnVwZGF0ZVRleHQoKX19ZnVuY3Rpb24gTyhlLHQsaSl7cmV0dXJuKHQ9ZnVuY3Rpb24oZSl7dmFyIHQ9ZnVuY3Rpb24oZSx0KXtpZihcIm9iamVjdFwiIT10eXBlb2YgZXx8bnVsbD09PWUpcmV0dXJuIGU7dmFyIGk9ZVtTeW1ib2wudG9QcmltaXRpdmVdO2lmKHZvaWQgMCE9PWkpe3ZhciBzPWkuY2FsbChlLFwic3RyaW5nXCIpO2lmKFwib2JqZWN0XCIhPXR5cGVvZiBzKXJldHVybiBzO3Rocm93IG5ldyBUeXBlRXJyb3IoXCJAQHRvUHJpbWl0aXZlIG11c3QgcmV0dXJuIGEgcHJpbWl0aXZlIHZhbHVlLlwiKX1yZXR1cm4gU3RyaW5nKGUpfShlKTtyZXR1cm5cInN5bWJvbFwiPT10eXBlb2YgdD90OlN0cmluZyh0KX0odCkpaW4gZT9PYmplY3QuZGVmaW5lUHJvcGVydHkoZSx0LHt2YWx1ZTppLGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwLHdyaXRhYmxlOiEwfSk6ZVt0XT1pLGV9Y2xhc3MgQXtjb25zdHJ1Y3RvcihlKXtsZXR7ZHA6dCxvcHRzOml9PWU7Tyh0aGlzLFwicHJlc3NlZEtleXNcIixuZXcgU2V0KSxPKHRoaXMsXCJob3RLZXlzXCIsbmV3IE1hcChbW1tbXCJDb250cm9sXCIsXCJBcnJvd1JpZ2h0XCJdLFtcIkNvbnRyb2xcIixcIkFycm93VXBcIl1dLGU9PmUubW9udGgrK10sW1tbXCJDb250cm9sXCIsXCJBcnJvd0xlZnRcIl0sW1wiQ29udHJvbFwiLFwiQXJyb3dEb3duXCJdXSxlPT5lLm1vbnRoLS1dLFtbW1wiU2hpZnRcIixcIkFycm93UmlnaHRcIl0sW1wiU2hpZnRcIixcIkFycm93VXBcIl1dLGU9PmUueWVhcisrXSxbW1tcIlNoaWZ0XCIsXCJBcnJvd0xlZnRcIl0sW1wiU2hpZnRcIixcIkFycm93RG93blwiXV0sZT0+ZS55ZWFyLS1dLFtbW1wiQWx0XCIsXCJBcnJvd1JpZ2h0XCJdLFtcIkFsdFwiLFwiQXJyb3dVcFwiXV0sZT0+ZS55ZWFyKz0xMF0sW1tbXCJBbHRcIixcIkFycm93TGVmdFwiXSxbXCJBbHRcIixcIkFycm93RG93blwiXV0sZT0+ZS55ZWFyLT0xMF0sW1tcIkNvbnRyb2xcIixcIlNoaWZ0XCIsXCJBcnJvd1VwXCJdLChlLHQpPT50LnVwKCldXSkpLE8odGhpcyxcImhhbmRsZUhvdEtleVwiLChlPT57bGV0IHQ9dGhpcy5ob3RLZXlzLmdldChlKSxpPW8odGhpcy5nZXRJbml0aWFsRm9jdXNEYXRlKCkpO3QoaSx0aGlzLmRwKTtsZXR7eWVhcjpzLG1vbnRoOmEsZGF0ZTpufT1pLHI9aChuZXcgRGF0ZShzLGEpKTtyPG4mJihuPXIpO2xldCBsPXRoaXMuZHAuZ2V0Q2xhbXBlZERhdGUobmV3IERhdGUocyxhLG4pKTt0aGlzLmRwLnNldEZvY3VzRGF0ZShsLHt2aWV3RGF0ZVRyYW5zaXRpb246ITB9KX0pKSxPKHRoaXMsXCJpc0hvdEtleVByZXNzZWRcIiwoKCk9PntsZXQgZT0hMSx0PXRoaXMucHJlc3NlZEtleXMuc2l6ZSxpPWU9PnRoaXMucHJlc3NlZEtleXMuaGFzKGUpO2ZvcihsZXRbc11vZiB0aGlzLmhvdEtleXMpe2lmKGUpYnJlYWs7aWYoQXJyYXkuaXNBcnJheShzWzBdKSlzLmZvckVhY2goKGE9PntlfHx0IT09YS5sZW5ndGh8fChlPWEuZXZlcnkoaSkmJnMpfSkpO2Vsc2V7aWYodCE9PXMubGVuZ3RoKWNvbnRpbnVlO2U9cy5ldmVyeShpKSYmc319cmV0dXJuIGV9KSksTyh0aGlzLFwiaXNBcnJvd1wiLChlPT5lPj0zNyYmZTw9NDApKSxPKHRoaXMsXCJvbktleURvd25cIiwoZT0+e2xldHtrZXk6dCx3aGljaDppfT1lLHtkcDpzLGRwOntmb2N1c0RhdGU6YX0sb3B0czpufT10aGlzO3RoaXMucmVnaXN0ZXJLZXkodCk7bGV0IHI9dGhpcy5pc0hvdEtleVByZXNzZWQoKTtpZihyKXJldHVybiBlLnByZXZlbnREZWZhdWx0KCksdm9pZCB0aGlzLmhhbmRsZUhvdEtleShyKTtpZih0aGlzLmlzQXJyb3coaSkpcmV0dXJuIGUucHJldmVudERlZmF1bHQoKSx2b2lkIHRoaXMuZm9jdXNOZXh0Q2VsbCh0KTtpZihcIkVudGVyXCI9PT10KXtpZihzLmN1cnJlbnRWaWV3IT09bi5taW5WaWV3KXJldHVybiB2b2lkIHMuZG93bigpO2lmKGEpe2xldCBlPXMuX2NoZWNrSWZEYXRlSXNTZWxlY3RlZChhKTtyZXR1cm4gdm9pZChlP3MuX2hhbmRsZUFscmVhZHlTZWxlY3RlZERhdGVzKGUsYSk6cy5zZWxlY3REYXRlKGEpKX19XCJFc2NhcGVcIj09PXQmJnRoaXMuZHAuaGlkZSgpfSkpLE8odGhpcyxcIm9uS2V5VXBcIiwoZT0+e3RoaXMucmVtb3ZlS2V5KGUua2V5KX0pKSx0aGlzLmRwPXQsdGhpcy5vcHRzPWksdGhpcy5pbml0KCl9aW5pdCgpe3RoaXMuYmluZEtleWJvYXJkRXZlbnRzKCl9YmluZEtleWJvYXJkRXZlbnRzKCl7bGV0eyRlbDplfT10aGlzLmRwO2UuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIix0aGlzLm9uS2V5RG93biksZS5hZGRFdmVudExpc3RlbmVyKFwia2V5dXBcIix0aGlzLm9uS2V5VXApfWRlc3Ryb3koKXtsZXR7JGVsOmV9PXRoaXMuZHA7ZS5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLHRoaXMub25LZXlEb3duKSxlLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXl1cFwiLHRoaXMub25LZXlVcCksdGhpcy5ob3RLZXlzPW51bGwsdGhpcy5wcmVzc2VkS2V5cz1udWxsfWdldEluaXRpYWxGb2N1c0RhdGUoKXtsZXR7Zm9jdXNEYXRlOmUsY3VycmVudFZpZXc6dCxzZWxlY3RlZERhdGVzOnMscGFyc2VkVmlld0RhdGU6e3llYXI6YSxtb250aDpufX09dGhpcy5kcCxyPWV8fHNbcy5sZW5ndGgtMV07aWYoIXIpc3dpdGNoKHQpe2Nhc2UgaS5kYXlzOnI9bmV3IERhdGUoYSxuLChuZXcgRGF0ZSkuZ2V0RGF0ZSgpKTticmVhaztjYXNlIGkubW9udGhzOnI9bmV3IERhdGUoYSxuLDEpO2JyZWFrO2Nhc2UgaS55ZWFyczpyPW5ldyBEYXRlKGEsMCwxKX1yZXR1cm4gcn1mb2N1c05leHRDZWxsKGUpe2xldCB0PXRoaXMuZ2V0SW5pdGlhbEZvY3VzRGF0ZSgpLHtjdXJyZW50VmlldzpzfT10aGlzLmRwLHtkYXlzOmEsbW9udGhzOm4seWVhcnM6cn09aSxoPW8odCksbD1oLnllYXIsZD1oLm1vbnRoLGM9aC5kYXRlO3N3aXRjaChlKXtjYXNlXCJBcnJvd0xlZnRcIjpzPT09YSYmKGMtPTEpLHM9PT1uJiYoZC09MSkscz09PXImJihsLT0xKTticmVhaztjYXNlXCJBcnJvd1VwXCI6cz09PWEmJihjLT03KSxzPT09biYmKGQtPTMpLHM9PT1yJiYobC09NCk7YnJlYWs7Y2FzZVwiQXJyb3dSaWdodFwiOnM9PT1hJiYoYys9MSkscz09PW4mJihkKz0xKSxzPT09ciYmKGwrPTEpO2JyZWFrO2Nhc2VcIkFycm93RG93blwiOnM9PT1hJiYoYys9Nykscz09PW4mJihkKz0zKSxzPT09ciYmKGwrPTQpfWxldCB1PXRoaXMuZHAuZ2V0Q2xhbXBlZERhdGUobmV3IERhdGUobCxkLGMpKTt0aGlzLmRwLnNldEZvY3VzRGF0ZSh1LHt2aWV3RGF0ZVRyYW5zaXRpb246ITB9KX1yZWdpc3RlcktleShlKXt0aGlzLnByZXNzZWRLZXlzLmFkZChlKX1yZW1vdmVLZXkoZSl7dGhpcy5wcmVzc2VkS2V5cy5kZWxldGUoZSl9fWxldCBOPXtvbihlLHQpe3RoaXMuX19ldmVudHN8fCh0aGlzLl9fZXZlbnRzPXt9KSx0aGlzLl9fZXZlbnRzW2VdP3RoaXMuX19ldmVudHNbZV0ucHVzaCh0KTp0aGlzLl9fZXZlbnRzW2VdPVt0XX0sb2ZmKGUsdCl7dGhpcy5fX2V2ZW50cyYmdGhpcy5fX2V2ZW50c1tlXSYmKHRoaXMuX19ldmVudHNbZV09dGhpcy5fX2V2ZW50c1tlXS5maWx0ZXIoKGU9PmUhPT10KSkpfSxyZW1vdmVBbGxFdmVudHMoKXt0aGlzLl9fZXZlbnRzPXt9fSx0cmlnZ2VyKGUpe2Zvcih2YXIgdD1hcmd1bWVudHMubGVuZ3RoLGk9bmV3IEFycmF5KHQ+MT90LTE6MCkscz0xO3M8dDtzKyspaVtzLTFdPWFyZ3VtZW50c1tzXTt0aGlzLl9fZXZlbnRzJiZ0aGlzLl9fZXZlbnRzW2VdJiZ0aGlzLl9fZXZlbnRzW2VdLmZvckVhY2goKGU9PntlKC4uLmkpfSkpfX07ZnVuY3Rpb24gSShlLHQsaSl7cmV0dXJuKHQ9ZnVuY3Rpb24oZSl7dmFyIHQ9ZnVuY3Rpb24oZSx0KXtpZihcIm9iamVjdFwiIT10eXBlb2YgZXx8bnVsbD09PWUpcmV0dXJuIGU7dmFyIGk9ZVtTeW1ib2wudG9QcmltaXRpdmVdO2lmKHZvaWQgMCE9PWkpe3ZhciBzPWkuY2FsbChlLFwic3RyaW5nXCIpO2lmKFwib2JqZWN0XCIhPXR5cGVvZiBzKXJldHVybiBzO3Rocm93IG5ldyBUeXBlRXJyb3IoXCJAQHRvUHJpbWl0aXZlIG11c3QgcmV0dXJuIGEgcHJpbWl0aXZlIHZhbHVlLlwiKX1yZXR1cm4gU3RyaW5nKGUpfShlKTtyZXR1cm5cInN5bWJvbFwiPT10eXBlb2YgdD90OlN0cmluZyh0KX0odCkpaW4gZT9PYmplY3QuZGVmaW5lUHJvcGVydHkoZSx0LHt2YWx1ZTppLGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwLHdyaXRhYmxlOiEwfSk6ZVt0XT1pLGV9bGV0IFA9XCJcIixqPVwiXCIsUj0hMTtjbGFzcyBCe3N0YXRpYyBidWlsZEdsb2JhbENvbnRhaW5lcihlKXtSPSEwLFA9bih7Y2xhc3NOYW1lOmUsaWQ6ZX0pLGEoXCJib2R5XCIpLmFwcGVuZENoaWxkKFApfWNvbnN0cnVjdG9yKGUsdCl7dmFyIHI9dGhpcztpZihJKHRoaXMsXCJ2aWV3SW5kZXhlc1wiLFtpLmRheXMsaS5tb250aHMsaS55ZWFyc10pLEkodGhpcyxcIm5leHRcIiwoKCk9PntsZXR7eWVhcjplLG1vbnRoOnR9PXRoaXMucGFyc2VkVmlld0RhdGU7c3dpdGNoKHRoaXMuY3VycmVudFZpZXcpe2Nhc2UgaS5kYXlzOnRoaXMuc2V0Vmlld0RhdGUobmV3IERhdGUoZSx0KzEsMSkpO2JyZWFrO2Nhc2UgaS5tb250aHM6dGhpcy5zZXRWaWV3RGF0ZShuZXcgRGF0ZShlKzEsdCwxKSk7YnJlYWs7Y2FzZSBpLnllYXJzOnRoaXMuc2V0Vmlld0RhdGUobmV3IERhdGUoZSsxMCwwLDEpKX19KSksSSh0aGlzLFwicHJldlwiLCgoKT0+e2xldHt5ZWFyOmUsbW9udGg6dH09dGhpcy5wYXJzZWRWaWV3RGF0ZTtzd2l0Y2godGhpcy5jdXJyZW50Vmlldyl7Y2FzZSBpLmRheXM6dGhpcy5zZXRWaWV3RGF0ZShuZXcgRGF0ZShlLHQtMSwxKSk7YnJlYWs7Y2FzZSBpLm1vbnRoczp0aGlzLnNldFZpZXdEYXRlKG5ldyBEYXRlKGUtMSx0LDEpKTticmVhaztjYXNlIGkueWVhcnM6dGhpcy5zZXRWaWV3RGF0ZShuZXcgRGF0ZShlLTEwLDAsMSkpfX0pKSxJKHRoaXMsXCJfZmluaXNoSGlkZVwiLCgoKT0+e3RoaXMuaGlkZUFuaW1hdGlvbj0hMSx0aGlzLl9kZXN0cm95Q29tcG9uZW50cygpLHRoaXMuJGNvbnRhaW5lci5yZW1vdmVDaGlsZCh0aGlzLiRkYXRlcGlja2VyKX0pKSxJKHRoaXMsXCJzZXRQb3NpdGlvblwiLChmdW5jdGlvbihlKXtsZXQgdD1hcmd1bWVudHMubGVuZ3RoPjEmJnZvaWQgMCE9PWFyZ3VtZW50c1sxXSYmYXJndW1lbnRzWzFdO2lmKFwiZnVuY3Rpb25cIj09dHlwZW9mKGU9ZXx8ci5vcHRzLnBvc2l0aW9uKSlyZXR1cm4gdm9pZChyLmN1c3RvbUhpZGU9ZSh7JGRhdGVwaWNrZXI6ci4kZGF0ZXBpY2tlciwkdGFyZ2V0OnIuJGVsLCRwb2ludGVyOnIuJHBvaW50ZXIsaXNWaWV3Q2hhbmdlOnQsZG9uZTpyLl9maW5pc2hIaWRlfSkpO2xldCBpLHMse2lzTW9iaWxlOmF9PXIub3B0cyxuPXIuJGVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLGg9ci4kZWwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCksbz1yLiRkYXRlcGlja2VyLm9mZnNldFBhcmVudCxsPXIuJGVsLm9mZnNldFBhcmVudCxkPXIuJGRhdGVwaWNrZXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCksYz1lLnNwbGl0KFwiIFwiKSx1PXdpbmRvdy5zY3JvbGxZLHA9d2luZG93LnNjcm9sbFgsbT1yLm9wdHMub2Zmc2V0LHY9Y1swXSxnPWNbMV07aWYoYSlyLiRkYXRlcGlja2VyLnN0eWxlLmNzc1RleHQ9XCJsZWZ0OiA1MCU7IHRvcDogNTAlXCI7ZWxzZXtpZihvPT09bCYmbyE9PWRvY3VtZW50LmJvZHkmJihoPXt0b3A6ci4kZWwub2Zmc2V0VG9wLGxlZnQ6ci4kZWwub2Zmc2V0TGVmdCx3aWR0aDpuLndpZHRoLGhlaWdodDpyLiRlbC5vZmZzZXRIZWlnaHR9LHU9MCxwPTApLG8hPT1sJiZvIT09ZG9jdW1lbnQuYm9keSl7bGV0IGU9by5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtoPXt0b3A6bi50b3AtZS50b3AsbGVmdDpuLmxlZnQtZS5sZWZ0LHdpZHRoOm4ud2lkdGgsaGVpZ2h0Om4uaGVpZ2h0fSx1PTAscD0wfXN3aXRjaCh2KXtjYXNlXCJ0b3BcIjppPWgudG9wLWQuaGVpZ2h0LW07YnJlYWs7Y2FzZVwicmlnaHRcIjpzPWgubGVmdCtoLndpZHRoK207YnJlYWs7Y2FzZVwiYm90dG9tXCI6aT1oLnRvcCtoLmhlaWdodCttO2JyZWFrO2Nhc2VcImxlZnRcIjpzPWgubGVmdC1kLndpZHRoLW19c3dpdGNoKGcpe2Nhc2VcInRvcFwiOmk9aC50b3A7YnJlYWs7Y2FzZVwicmlnaHRcIjpzPWgubGVmdCtoLndpZHRoLWQud2lkdGg7YnJlYWs7Y2FzZVwiYm90dG9tXCI6aT1oLnRvcCtoLmhlaWdodC1kLmhlaWdodDticmVhaztjYXNlXCJsZWZ0XCI6cz1oLmxlZnQ7YnJlYWs7Y2FzZVwiY2VudGVyXCI6L2xlZnR8cmlnaHQvLnRlc3Qodik/aT1oLnRvcCtoLmhlaWdodC8yLWQuaGVpZ2h0LzI6cz1oLmxlZnQraC53aWR0aC8yLWQud2lkdGgvMn1yLiRkYXRlcGlja2VyLnN0eWxlLmNzc1RleHQ9YGxlZnQ6ICR7cytwfXB4OyB0b3A6ICR7aSt1fXB4YH19KSksSSh0aGlzLFwiX3NldElucHV0VmFsdWVcIiwoKCk9PntsZXR7b3B0czplLCRhbHRGaWVsZDp0LGxvY2FsZTp7ZGF0ZUZvcm1hdDppfX09dGhpcyx7YWx0RmllbGREYXRlRm9ybWF0OnMsYWx0RmllbGQ6YX09ZTthJiZ0JiYodC52YWx1ZT10aGlzLl9nZXRJbnB1dFZhbHVlKHMpKSx0aGlzLiRlbC52YWx1ZT10aGlzLl9nZXRJbnB1dFZhbHVlKGkpfSkpLEkodGhpcyxcIl9nZXRJbnB1dFZhbHVlXCIsKGU9PntsZXR7c2VsZWN0ZWREYXRlczp0LG9wdHM6aX09dGhpcyx7bXVsdGlwbGVEYXRlczpzLG11bHRpcGxlRGF0ZXNTZXBhcmF0b3I6YX09aTtpZighdC5sZW5ndGgpcmV0dXJuXCJcIjtsZXQgbj1cImZ1bmN0aW9uXCI9PXR5cGVvZiBlLHI9bj9lKHM/dDp0WzBdKTp0Lm1hcCgodD0+dGhpcy5mb3JtYXREYXRlKHQsZSkpKTtyZXR1cm4gcj1uP3I6ci5qb2luKGEpLHJ9KSksSSh0aGlzLFwiX2NoZWNrSWZEYXRlSXNTZWxlY3RlZFwiLChmdW5jdGlvbihlKXtsZXQgdD1hcmd1bWVudHMubGVuZ3RoPjEmJnZvaWQgMCE9PWFyZ3VtZW50c1sxXT9hcmd1bWVudHNbMV06aS5kYXlzLHM9ITE7cmV0dXJuIHIuc2VsZWN0ZWREYXRlcy5zb21lKChpPT57bGV0IGE9cChlLGksdCk7cmV0dXJuIHM9YSYmaSxhfSkpLHN9KSksSSh0aGlzLFwiX3NjaGVkdWxlQ2FsbEFmdGVyVHJhbnNpdGlvblwiLChlPT57dGhpcy5fY2FuY2VsU2NoZWR1bGVkQ2FsbCgpLGUmJmUoITEpLHRoaXMuX29uVHJhbnNpdGlvbkVuZD0oKT0+e2UmJmUoITApfSx0aGlzLiRkYXRlcGlja2VyLmFkZEV2ZW50TGlzdGVuZXIoXCJ0cmFuc2l0aW9uZW5kXCIsdGhpcy5fb25UcmFuc2l0aW9uRW5kLHtvbmNlOiEwfSl9KSksSSh0aGlzLFwiX2NhbmNlbFNjaGVkdWxlZENhbGxcIiwoKCk9Pnt0aGlzLiRkYXRlcGlja2VyLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJ0cmFuc2l0aW9uZW5kXCIsdGhpcy5fb25UcmFuc2l0aW9uRW5kKX0pKSxJKHRoaXMsXCJzZXRWaWV3RGF0ZVwiLChlPT57aWYoISgoZT1iKGUpKWluc3RhbmNlb2YgRGF0ZSkpcmV0dXJuO2lmKHAoZSx0aGlzLnZpZXdEYXRlKSlyZXR1cm47bGV0IHQ9dGhpcy52aWV3RGF0ZTt0aGlzLnZpZXdEYXRlPWU7bGV0e29uQ2hhbmdlVmlld0RhdGU6c309dGhpcy5vcHRzO2lmKHMpe2xldHttb250aDplLHllYXI6dH09dGhpcy5wYXJzZWRWaWV3RGF0ZTtzKHttb250aDplLHllYXI6dCxkZWNhZGU6dGhpcy5jdXJEZWNhZGV9KX10aGlzLnRyaWdnZXIoaS5ldmVudENoYW5nZVZpZXdEYXRlLGUsdCl9KSksSSh0aGlzLFwic2V0Rm9jdXNEYXRlXCIsKGZ1bmN0aW9uKGUpe2xldCB0PWFyZ3VtZW50cy5sZW5ndGg+MSYmdm9pZCAwIT09YXJndW1lbnRzWzFdP2FyZ3VtZW50c1sxXTp7fTsoIWV8fChlPWIoZSkpaW5zdGFuY2VvZiBEYXRlKSYmKHIuZm9jdXNEYXRlPWUsci5vcHRzLnJhbmdlJiZlJiZyLl9oYW5kbGVSYW5nZU9uRm9jdXMoKSxyLnRyaWdnZXIoaS5ldmVudENoYW5nZUZvY3VzRGF0ZSxlLHQpKX0pKSxJKHRoaXMsXCJzZXRDdXJyZW50Vmlld1wiLChlPT57aWYodGhpcy52aWV3SW5kZXhlcy5pbmNsdWRlcyhlKSl7aWYodGhpcy5jdXJyZW50Vmlldz1lLHRoaXMuZWxJc0lucHV0JiZ0aGlzLnZpc2libGUmJnRoaXMuc2V0UG9zaXRpb24odm9pZCAwLCEwKSx0aGlzLnRyaWdnZXIoaS5ldmVudENoYW5nZUN1cnJlbnRWaWV3LGUpLCF0aGlzLnZpZXdzW2VdKXtsZXQgdD10aGlzLnZpZXdzW2VdPW5ldyBUKHtkcDp0aGlzLG9wdHM6dGhpcy5vcHRzLHR5cGU6ZX0pO3RoaXMuc2hvdWxkVXBkYXRlRE9NJiZ0aGlzLiRjb250ZW50LmFwcGVuZENoaWxkKHQuJGVsKX10aGlzLm9wdHMub25DaGFuZ2VWaWV3JiZ0aGlzLm9wdHMub25DaGFuZ2VWaWV3KGUpfX0pKSxJKHRoaXMsXCJfdXBkYXRlTGFzdFNlbGVjdGVkRGF0ZVwiLChlPT57dGhpcy5sYXN0U2VsZWN0ZWREYXRlPWUsdGhpcy50cmlnZ2VyKGkuZXZlbnRDaGFuZ2VMYXN0U2VsZWN0ZWREYXRlLGUpfSkpLEkodGhpcyxcImRlc3Ryb3lcIiwoKCk9PntsZXR7c2hvd0V2ZW50OmUsaXNNb2JpbGU6dH09dGhpcy5vcHRzLGk9dGhpcy4kZGF0ZXBpY2tlci5wYXJlbnROb2RlO2kmJmkucmVtb3ZlQ2hpbGQodGhpcy4kZGF0ZXBpY2tlciksdGhpcy4kZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcihlLHRoaXMuX29uRm9jdXMpLHRoaXMuJGVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJibHVyXCIsdGhpcy5fb25CbHVyKSx3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInJlc2l6ZVwiLHRoaXMuX29uUmVzaXplKSx0JiZ0aGlzLl9yZW1vdmVNb2JpbGVBdHRyaWJ1dGVzKCksdGhpcy5rZXlib2FyZE5hdiYmdGhpcy5rZXlib2FyZE5hdi5kZXN0cm95KCksdGhpcy52aWV3cz1udWxsLHRoaXMubmF2PW51bGwsdGhpcy4kZGF0ZXBpY2tlcj1udWxsLHRoaXMub3B0cz1udWxsLHRoaXMuJGN1c3RvbUNvbnRhaW5lcj1udWxsLHRoaXMudmlld0RhdGU9bnVsbCx0aGlzLmZvY3VzRGF0ZT1udWxsLHRoaXMuc2VsZWN0ZWREYXRlcz1udWxsLHRoaXMucmFuZ2VEYXRlRnJvbT1udWxsLHRoaXMucmFuZ2VEYXRlVG89bnVsbH0pKSxJKHRoaXMsXCJ1cGRhdGVcIiwoZnVuY3Rpb24oKXtsZXQgZT1hcmd1bWVudHMubGVuZ3RoPjAmJnZvaWQgMCE9PWFyZ3VtZW50c1swXT9hcmd1bWVudHNbMF06e30sdD13KHt9LHIub3B0cyk7dyhyLm9wdHMsZSk7bGV0e3RpbWVwaWNrZXI6cyxidXR0b25zOmEscmFuZ2U6bixzZWxlY3RlZERhdGVzOmgsaXNNb2JpbGU6b309ci5vcHRzLGw9ci52aXNpYmxlfHxyLnRyZWF0QXNJbmxpbmU7ci5fY3JlYXRlTWluTWF4RGF0ZXMoKSxyLl9saW1pdFZpZXdEYXRlQnlNYXhNaW5EYXRlcygpLHIuX2hhbmRsZUxvY2FsZSgpLCF0LnNlbGVjdGVkRGF0ZXMmJmgmJnIuc2VsZWN0RGF0ZShoKSxlLnZpZXcmJnIuc2V0Q3VycmVudFZpZXcoZS52aWV3KSxyLl9zZXRJbnB1dFZhbHVlKCksdC5yYW5nZSYmIW4/KHIucmFuZ2VEYXRlVG89ITEsci5yYW5nZURhdGVGcm9tPSExKTohdC5yYW5nZSYmbiYmci5zZWxlY3RlZERhdGVzLmxlbmd0aCYmKHIucmFuZ2VEYXRlRnJvbT1yLnNlbGVjdGVkRGF0ZXNbMF0sci5yYW5nZURhdGVUbz1yLnNlbGVjdGVkRGF0ZXNbMV0pLHQudGltZXBpY2tlciYmIXM/KGwmJnIudGltZXBpY2tlci5kZXN0cm95KCksci50aW1lcGlja2VyPSExLHIuJHRpbWVwaWNrZXIucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChyLiR0aW1lcGlja2VyKSk6IXQudGltZXBpY2tlciYmcyYmci5fYWRkVGltZXBpY2tlcigpLCF0LmJ1dHRvbnMmJmE/ci5fYWRkQnV0dG9ucygpOnQuYnV0dG9ucyYmIWE/KHIuYnV0dG9ucy5kZXN0cm95KCksci4kYnV0dG9ucy5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHIuJGJ1dHRvbnMpKTpsJiZ0LmJ1dHRvbnMmJmEmJnIuYnV0dG9ucy5jbGVhckh0bWwoKS5yZW5kZXIoKSwhdC5pc01vYmlsZSYmbz8oci50cmVhdEFzSW5saW5lfHxqfHxyLl9jcmVhdGVNb2JpbGVPdmVybGF5KCksci5fYWRkTW9iaWxlQXR0cmlidXRlcygpLHIudmlzaWJsZSYmci5fc2hvd01vYmlsZU92ZXJsYXkoKSk6dC5pc01vYmlsZSYmIW8mJihyLl9yZW1vdmVNb2JpbGVBdHRyaWJ1dGVzKCksci52aXNpYmxlJiYoai5jbGFzc0xpc3QucmVtb3ZlKFwiLWFjdGl2ZS1cIiksXCJmdW5jdGlvblwiIT10eXBlb2Ygci5vcHRzLnBvc2l0aW9uJiZyLnNldFBvc2l0aW9uKCkpKSxsJiYoci5uYXYudXBkYXRlKCksci52aWV3c1tyLmN1cnJlbnRWaWV3XS5yZW5kZXIoKSxyLmN1cnJlbnRWaWV3PT09aS5kYXlzJiZyLnZpZXdzW3IuY3VycmVudFZpZXddLnJlbmRlckRheU5hbWVzKCkpfSkpLEkodGhpcyxcImlzT3RoZXJNb250aFwiLChlPT57bGV0e21vbnRoOnR9PW8oZSk7cmV0dXJuIHQhPT10aGlzLnBhcnNlZFZpZXdEYXRlLm1vbnRofSkpLEkodGhpcyxcImlzT3RoZXJZZWFyXCIsKGU9PntsZXR7eWVhcjp0fT1vKGUpO3JldHVybiB0IT09dGhpcy5wYXJzZWRWaWV3RGF0ZS55ZWFyfSkpLEkodGhpcyxcImlzT3RoZXJEZWNhZGVcIiwoZT0+e2xldHt5ZWFyOnR9PW8oZSksW2ksc109Yyh0aGlzLnZpZXdEYXRlKTtyZXR1cm4gdDxpfHx0PnN9KSksSSh0aGlzLFwiX29uQ2hhbmdlU2VsZWN0ZWREYXRlXCIsKGU9PntsZXR7c2lsZW50OnR9PWU7c2V0VGltZW91dCgoKCk9Pnt0aGlzLl9zZXRJbnB1dFZhbHVlKCksdGhpcy5vcHRzLm9uU2VsZWN0JiYhdCYmdGhpcy5fdHJpZ2dlck9uU2VsZWN0KCl9KSl9KSksSSh0aGlzLFwiX29uQ2hhbmdlRm9jdXNlZERhdGVcIiwoZnVuY3Rpb24oZSl7bGV0e3ZpZXdEYXRlVHJhbnNpdGlvbjp0fT1hcmd1bWVudHMubGVuZ3RoPjEmJnZvaWQgMCE9PWFyZ3VtZW50c1sxXT9hcmd1bWVudHNbMV06e307aWYoIWUpcmV0dXJuO2xldCBpPSExO3QmJihpPXIuaXNPdGhlck1vbnRoKGUpfHxyLmlzT3RoZXJZZWFyKGUpfHxyLmlzT3RoZXJEZWNhZGUoZSkpLGkmJnIuc2V0Vmlld0RhdGUoZSksci5vcHRzLm9uRm9jdXMmJnIub3B0cy5vbkZvY3VzKHtkYXRlcGlja2VyOnIsZGF0ZTplfSl9KSksSSh0aGlzLFwiX29uQ2hhbmdlVGltZVwiLChlPT57bGV0e2hvdXJzOnQsbWludXRlczppfT1lLHM9bmV3IERhdGUse2xhc3RTZWxlY3RlZERhdGU6YSxvcHRzOntvblNlbGVjdDpufX09dGhpcyxyPWE7YXx8KHI9cyk7bGV0IGg9dGhpcy5nZXRDZWxsKHIsdGhpcy5jdXJyZW50Vmlld1Npbmd1bGFyKSxvPWgmJmguYWRwQ2VsbDtvJiZvLmlzRGlzYWJsZWR8fChyLnNldEhvdXJzKHQpLHIuc2V0TWludXRlcyhpKSxhPyh0aGlzLl9zZXRJbnB1dFZhbHVlKCksbiYmdGhpcy5fdHJpZ2dlck9uU2VsZWN0KCkpOnRoaXMuc2VsZWN0RGF0ZShyKSl9KSksSSh0aGlzLFwiX29uRm9jdXNcIiwoZT0+e3RoaXMudmlzaWJsZXx8dGhpcy5zaG93KCl9KSksSSh0aGlzLFwiX29uQmx1clwiLChlPT57dGhpcy5pbkZvY3VzfHwhdGhpcy52aXNpYmxlfHx0aGlzLm9wdHMuaXNNb2JpbGV8fHRoaXMuaGlkZSgpfSkpLEkodGhpcyxcIl9vbk1vdXNlRG93blwiLChlPT57dGhpcy5pbkZvY3VzPSEwfSkpLEkodGhpcyxcIl9vbk1vdXNlVXBcIiwoZT0+e3RoaXMuaW5Gb2N1cz0hMSx0aGlzLiRlbC5mb2N1cygpfSkpLEkodGhpcyxcIl9vblJlc2l6ZVwiLCgoKT0+e3RoaXMudmlzaWJsZSYmXCJmdW5jdGlvblwiIT10eXBlb2YgdGhpcy5vcHRzLnBvc2l0aW9uJiZ0aGlzLnNldFBvc2l0aW9uKCl9KSksSSh0aGlzLFwiX29uQ2xpY2tPdmVybGF5XCIsKCgpPT57dGhpcy52aXNpYmxlJiZ0aGlzLmhpZGUoKX0pKSxJKHRoaXMsXCJnZXRWaWV3RGF0ZXNcIiwoZnVuY3Rpb24oKXtsZXQgZT1hcmd1bWVudHMubGVuZ3RoPjAmJnZvaWQgMCE9PWFyZ3VtZW50c1swXT9hcmd1bWVudHNbMF06aS5kYXlzO3JldHVybiBULmdldERhdGVzRnVuY3Rpb24oZSkocil9KSksSSh0aGlzLFwiaXNXZWVrZW5kXCIsKGU9PnRoaXMub3B0cy53ZWVrZW5kcy5pbmNsdWRlcyhlKSkpLEkodGhpcyxcImdldENsYW1wZWREYXRlXCIsKGU9PntsZXR7bWluRGF0ZTp0LG1heERhdGU6aX09dGhpcyxzPWU7cmV0dXJuIGkmJm0oZSxpKT9zPWk6dCYmdihlLHQpJiYocz10KSxzfSkpLHRoaXMuJGVsPWEoZSksIXRoaXMuJGVsKXJldHVybjt0aGlzLiRkYXRlcGlja2VyPW4oe2NsYXNzTmFtZTpcImFpci1kYXRlcGlja2VyXCJ9KSx0aGlzLm9wdHM9dyh7fSxzLHQpLHRoaXMuJGN1c3RvbUNvbnRhaW5lcj0hIXRoaXMub3B0cy5jb250YWluZXImJmEodGhpcy5vcHRzLmNvbnRhaW5lciksdGhpcy4kYWx0RmllbGQ9YSh0aGlzLm9wdHMuYWx0RmllbGR8fCExKTtsZXR7dmlldzpoLHN0YXJ0RGF0ZTpsfT10aGlzLm9wdHM7bHx8KHRoaXMub3B0cy5zdGFydERhdGU9bmV3IERhdGUpLFwiSU5QVVRcIj09PXRoaXMuJGVsLm5vZGVOYW1lJiYodGhpcy5lbElzSW5wdXQ9ITApLHRoaXMuaW5pdGVkPSExLHRoaXMudmlzaWJsZT0hMSx0aGlzLnZpZXdEYXRlPWIodGhpcy5vcHRzLnN0YXJ0RGF0ZSksdGhpcy5mb2N1c0RhdGU9ITEsdGhpcy5pbml0aWFsUmVhZG9ubHk9dGhpcy4kZWwuZ2V0QXR0cmlidXRlKFwicmVhZG9ubHlcIiksdGhpcy5jdXN0b21IaWRlPSExLHRoaXMuY3VycmVudFZpZXc9aCx0aGlzLnNlbGVjdGVkRGF0ZXM9W10sdGhpcy52aWV3cz17fSx0aGlzLmtleXM9W10sdGhpcy5yYW5nZURhdGVGcm9tPVwiXCIsdGhpcy5yYW5nZURhdGVUbz1cIlwiLHRoaXMudGltZXBpY2tlcklzQWN0aXZlPSExLHRoaXMudHJlYXRBc0lubGluZT10aGlzLm9wdHMuaW5saW5lfHwhdGhpcy5lbElzSW5wdXQsdGhpcy5pbml0KCl9aW5pdCgpe2xldHtvcHRzOmUsdHJlYXRBc0lubGluZTp0LG9wdHM6e2lubGluZTppLGlzTW9iaWxlOnMsc2VsZWN0ZWREYXRlczpuLGtleWJvYXJkTmF2OnIsb25seVRpbWVwaWNrZXI6aH19PXRoaXMsbz1hKFwiYm9keVwiKTsoIVJ8fFImJlAmJiFvLmNvbnRhaW5zKFApKSYmIWkmJnRoaXMuZWxJc0lucHV0JiYhdGhpcy4kY3VzdG9tQ29udGFpbmVyJiZCLmJ1aWxkR2xvYmFsQ29udGFpbmVyKEIuZGVmYXVsdEdsb2JhbENvbnRhaW5lcklkKSwhc3x8anx8dHx8dGhpcy5fY3JlYXRlTW9iaWxlT3ZlcmxheSgpLHRoaXMuX2hhbmRsZUxvY2FsZSgpLHRoaXMuX2JpbmRTdWJFdmVudHMoKSx0aGlzLl9jcmVhdGVNaW5NYXhEYXRlcygpLHRoaXMuX2xpbWl0Vmlld0RhdGVCeU1heE1pbkRhdGVzKCksdGhpcy5lbElzSW5wdXQmJihpfHx0aGlzLl9iaW5kRXZlbnRzKCksciYmIWgmJih0aGlzLmtleWJvYXJkTmF2PW5ldyBBKHtkcDp0aGlzLG9wdHM6ZX0pKSksbiYmdGhpcy5zZWxlY3REYXRlKG4se3NpbGVudDohMH0pLHRoaXMub3B0cy52aXNpYmxlJiYhdCYmdGhpcy5zaG93KCkscyYmIXQmJnRoaXMuJGVsLnNldEF0dHJpYnV0ZShcInJlYWRvbmx5XCIsITApLHQmJnRoaXMuX2NyZWF0ZUNvbXBvbmVudHMoKX1fY3JlYXRlTW9iaWxlT3ZlcmxheSgpe2o9bih7Y2xhc3NOYW1lOlwiYWlyLWRhdGVwaWNrZXItb3ZlcmxheVwifSksUC5hcHBlbmRDaGlsZChqKX1fY3JlYXRlQ29tcG9uZW50cygpe2xldHtvcHRzOmUsdHJlYXRBc0lubGluZTp0LG9wdHM6e2lubGluZTppLGJ1dHRvbnM6cyx0aW1lcGlja2VyOmEscG9zaXRpb246bixjbGFzc2VzOnIsb25seVRpbWVwaWNrZXI6aCxpc01vYmlsZTpvfX09dGhpczt0aGlzLl9idWlsZEJhc2VIdG1sKCksdGhpcy5lbElzSW5wdXQmJihpfHx0aGlzLl9zZXRQb3NpdGlvbkNsYXNzZXMobikpLCFpJiZ0aGlzLmVsSXNJbnB1dHx8dGhpcy4kZGF0ZXBpY2tlci5jbGFzc0xpc3QuYWRkKFwiLWlubGluZS1cIiksciYmdGhpcy4kZGF0ZXBpY2tlci5jbGFzc0xpc3QuYWRkKC4uLnIuc3BsaXQoXCIgXCIpKSxoJiZ0aGlzLiRkYXRlcGlja2VyLmNsYXNzTGlzdC5hZGQoXCItb25seS10aW1lcGlja2VyLVwiKSxvJiYhdCYmdGhpcy5fYWRkTW9iaWxlQXR0cmlidXRlcygpLHRoaXMudmlld3NbdGhpcy5jdXJyZW50Vmlld109bmV3IFQoe2RwOnRoaXMsdHlwZTp0aGlzLmN1cnJlbnRWaWV3LG9wdHM6ZX0pLHRoaXMubmF2PW5ldyBWKHtkcDp0aGlzLG9wdHM6ZX0pLGEmJnRoaXMuX2FkZFRpbWVwaWNrZXIoKSxzJiZ0aGlzLl9hZGRCdXR0b25zKCksdGhpcy4kY29udGVudC5hcHBlbmRDaGlsZCh0aGlzLnZpZXdzW3RoaXMuY3VycmVudFZpZXddLiRlbCksdGhpcy4kbmF2LmFwcGVuZENoaWxkKHRoaXMubmF2LiRlbCl9X2Rlc3Ryb3lDb21wb25lbnRzKCl7Zm9yKGxldCBlIGluIHRoaXMudmlld3MpdGhpcy52aWV3c1tlXS5kZXN0cm95KCk7dGhpcy52aWV3cz17fSx0aGlzLm5hdi5kZXN0cm95KCksdGhpcy50aW1lcGlja2VyJiZ0aGlzLnRpbWVwaWNrZXIuZGVzdHJveSgpfV9hZGRNb2JpbGVBdHRyaWJ1dGVzKCl7ai5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIix0aGlzLl9vbkNsaWNrT3ZlcmxheSksdGhpcy4kZGF0ZXBpY2tlci5jbGFzc0xpc3QuYWRkKFwiLWlzLW1vYmlsZS1cIiksdGhpcy4kZWwuc2V0QXR0cmlidXRlKFwicmVhZG9ubHlcIiwhMCl9X3JlbW92ZU1vYmlsZUF0dHJpYnV0ZXMoKXtqLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLHRoaXMuX29uQ2xpY2tPdmVybGF5KSx0aGlzLiRkYXRlcGlja2VyLmNsYXNzTGlzdC5yZW1vdmUoXCItaXMtbW9iaWxlLVwiKSx0aGlzLmluaXRpYWxSZWFkb25seXx8XCJcIj09PXRoaXMuaW5pdGlhbFJlYWRvbmx5fHx0aGlzLiRlbC5yZW1vdmVBdHRyaWJ1dGUoXCJyZWFkb25seVwiKX1fY3JlYXRlTWluTWF4RGF0ZXMoKXtsZXR7bWluRGF0ZTplLG1heERhdGU6dH09dGhpcy5vcHRzO3RoaXMubWluRGF0ZT0hIWUmJmIoZSksdGhpcy5tYXhEYXRlPSEhdCYmYih0KX1fYWRkVGltZXBpY2tlcigpe3RoaXMuJHRpbWVwaWNrZXI9bih7Y2xhc3NOYW1lOlwiYWlyLWRhdGVwaWNrZXItLXRpbWVcIn0pLHRoaXMuJGRhdGVwaWNrZXIuYXBwZW5kQ2hpbGQodGhpcy4kdGltZXBpY2tlciksdGhpcy50aW1lcGlja2VyPW5ldyBMKHtkcDp0aGlzLG9wdHM6dGhpcy5vcHRzfSksdGhpcy4kdGltZXBpY2tlci5hcHBlbmRDaGlsZCh0aGlzLnRpbWVwaWNrZXIuJGVsKX1fYWRkQnV0dG9ucygpe3RoaXMuJGJ1dHRvbnM9bih7Y2xhc3NOYW1lOlwiYWlyLWRhdGVwaWNrZXItLWJ1dHRvbnNcIn0pLHRoaXMuJGRhdGVwaWNrZXIuYXBwZW5kQ2hpbGQodGhpcy4kYnV0dG9ucyksdGhpcy5idXR0b25zPW5ldyBIKHtkcDp0aGlzLG9wdHM6dGhpcy5vcHRzfSksdGhpcy4kYnV0dG9ucy5hcHBlbmRDaGlsZCh0aGlzLmJ1dHRvbnMuJGVsKX1fYmluZFN1YkV2ZW50cygpe3RoaXMub24oaS5ldmVudENoYW5nZVNlbGVjdGVkRGF0ZSx0aGlzLl9vbkNoYW5nZVNlbGVjdGVkRGF0ZSksdGhpcy5vbihpLmV2ZW50Q2hhbmdlRm9jdXNEYXRlLHRoaXMuX29uQ2hhbmdlRm9jdXNlZERhdGUpLHRoaXMub24oaS5ldmVudENoYW5nZVRpbWUsdGhpcy5fb25DaGFuZ2VUaW1lKX1fYnVpbGRCYXNlSHRtbCgpe2xldHtpbmxpbmU6ZX09dGhpcy5vcHRzO3ZhciB0LGk7dGhpcy5lbElzSW5wdXQ/ZT8odD10aGlzLiRkYXRlcGlja2VyLChpPXRoaXMuJGVsKS5wYXJlbnROb2RlLmluc2VydEJlZm9yZSh0LGkubmV4dFNpYmxpbmcpKTp0aGlzLiRjb250YWluZXIuYXBwZW5kQ2hpbGQodGhpcy4kZGF0ZXBpY2tlcik6dGhpcy4kZWwuYXBwZW5kQ2hpbGQodGhpcy4kZGF0ZXBpY2tlciksdGhpcy4kZGF0ZXBpY2tlci5pbm5lckhUTUw9JzxpIGNsYXNzPVwiYWlyLWRhdGVwaWNrZXItLXBvaW50ZXJcIj48L2k+PGRpdiBjbGFzcz1cImFpci1kYXRlcGlja2VyLS1uYXZpZ2F0aW9uXCI+PC9kaXY+PGRpdiBjbGFzcz1cImFpci1kYXRlcGlja2VyLS1jb250ZW50XCI+PC9kaXY+Jyx0aGlzLiRjb250ZW50PWEoXCIuYWlyLWRhdGVwaWNrZXItLWNvbnRlbnRcIix0aGlzLiRkYXRlcGlja2VyKSx0aGlzLiRwb2ludGVyPWEoXCIuYWlyLWRhdGVwaWNrZXItLXBvaW50ZXJcIix0aGlzLiRkYXRlcGlja2VyKSx0aGlzLiRuYXY9YShcIi5haXItZGF0ZXBpY2tlci0tbmF2aWdhdGlvblwiLHRoaXMuJGRhdGVwaWNrZXIpfV9oYW5kbGVMb2NhbGUoKXtsZXR7bG9jYWxlOmUsZGF0ZUZvcm1hdDp0LGZpcnN0RGF5OmksdGltZXBpY2tlcjpzLG9ubHlUaW1lcGlja2VyOmEsdGltZUZvcm1hdDpuLGRhdGVUaW1lU2VwYXJhdG9yOnJ9PXRoaXMub3B0czt2YXIgaDt0aGlzLmxvY2FsZT0oaD1lLEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoaCkpKSx0JiYodGhpcy5sb2NhbGUuZGF0ZUZvcm1hdD10KSx2b2lkIDAhPT1uJiZcIlwiIT09biYmKHRoaXMubG9jYWxlLnRpbWVGb3JtYXQ9bik7bGV0e3RpbWVGb3JtYXQ6b309dGhpcy5sb2NhbGU7aWYoXCJcIiE9PWkmJih0aGlzLmxvY2FsZS5maXJzdERheT1pKSxzJiZcImZ1bmN0aW9uXCIhPXR5cGVvZiB0KXtsZXQgZT1vP3I6XCJcIjt0aGlzLmxvY2FsZS5kYXRlRm9ybWF0PVt0aGlzLmxvY2FsZS5kYXRlRm9ybWF0LG98fFwiXCJdLmpvaW4oZSl9YSYmXCJmdW5jdGlvblwiIT10eXBlb2YgdCYmKHRoaXMubG9jYWxlLmRhdGVGb3JtYXQ9dGhpcy5sb2NhbGUudGltZUZvcm1hdCl9X3NldFBvc2l0aW9uQ2xhc3NlcyhlKXtpZihcImZ1bmN0aW9uXCI9PXR5cGVvZiBlKXJldHVybiB2b2lkIHRoaXMuJGRhdGVwaWNrZXIuY2xhc3NMaXN0LmFkZChcIi1jdXN0b20tcG9zaXRpb24tXCIpO2xldCB0PShlPWUuc3BsaXQoXCIgXCIpKVswXSxpPWBhaXItZGF0ZXBpY2tlciAtJHt0fS0ke2VbMV19LSAtZnJvbS0ke3R9LWA7dGhpcy4kZGF0ZXBpY2tlci5jbGFzc0xpc3QuYWRkKC4uLmkuc3BsaXQoXCIgXCIpKX1fYmluZEV2ZW50cygpe3RoaXMuJGVsLmFkZEV2ZW50TGlzdGVuZXIodGhpcy5vcHRzLnNob3dFdmVudCx0aGlzLl9vbkZvY3VzKSx0aGlzLiRlbC5hZGRFdmVudExpc3RlbmVyKFwiYmx1clwiLHRoaXMuX29uQmx1ciksdGhpcy4kZGF0ZXBpY2tlci5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsdGhpcy5fb25Nb3VzZURvd24pLHRoaXMuJGRhdGVwaWNrZXIuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNldXBcIix0aGlzLl9vbk1vdXNlVXApLHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwicmVzaXplXCIsdGhpcy5fb25SZXNpemUpfV9saW1pdFZpZXdEYXRlQnlNYXhNaW5EYXRlcygpe2xldHt2aWV3RGF0ZTplLG1pbkRhdGU6dCxtYXhEYXRlOml9PXRoaXM7aSYmbShlLGkpJiZ0aGlzLnNldFZpZXdEYXRlKGkpLHQmJnYoZSx0KSYmdGhpcy5zZXRWaWV3RGF0ZSh0KX1mb3JtYXREYXRlKCl7bGV0IGU9YXJndW1lbnRzLmxlbmd0aD4wJiZ2b2lkIDAhPT1hcmd1bWVudHNbMF0/YXJndW1lbnRzWzBdOnRoaXMudmlld0RhdGUsdD1hcmd1bWVudHMubGVuZ3RoPjE/YXJndW1lbnRzWzFdOnZvaWQgMDtpZihlPWIoZSksIShlIGluc3RhbmNlb2YgRGF0ZSkpcmV0dXJuO2xldCBpPXQscz10aGlzLmxvY2FsZSxhPW8oZSksbj1hLmRheVBlcmlvZCxyPWMoZSksaD1CLnJlcGxhY2VyLGw9e1Q6ZS5nZXRUaW1lKCksbTphLm1pbnV0ZXMsbW06YS5mdWxsTWludXRlcyxoOmEuaG91cnMxMixoaDphLmZ1bGxIb3VyczEyLEg6YS5ob3VycyxISDphLmZ1bGxIb3VycyxhYTpuLEFBOm4udG9VcHBlckNhc2UoKSxFOnMuZGF5c1Nob3J0W2EuZGF5XSxFRUVFOnMuZGF5c1thLmRheV0sZDphLmRhdGUsZGQ6YS5mdWxsRGF0ZSxNOmEubW9udGgrMSxNTTphLmZ1bGxNb250aCxNTU06cy5tb250aHNTaG9ydFthLm1vbnRoXSxNTU1NOnMubW9udGhzW2EubW9udGhdLHl5OmEueWVhci50b1N0cmluZygpLnNsaWNlKC0yKSx5eXl5OmEueWVhcix5eXl5MTpyWzBdLHl5eXkyOnJbMV19O2ZvcihsZXRbZSx0XW9mIE9iamVjdC5lbnRyaWVzKGwpKWk9aChpLGsoZSksdCk7cmV0dXJuIGl9ZG93bihlKXt0aGlzLl9oYW5kbGVVcERvd25BY3Rpb25zKGUsXCJkb3duXCIpfXVwKGUpe3RoaXMuX2hhbmRsZVVwRG93bkFjdGlvbnMoZSxcInVwXCIpfXNlbGVjdERhdGUoZSl7bGV0IHQscz1hcmd1bWVudHMubGVuZ3RoPjEmJnZvaWQgMCE9PWFyZ3VtZW50c1sxXT9hcmd1bWVudHNbMV06e30se2N1cnJlbnRWaWV3OmEscGFyc2VkVmlld0RhdGU6bixzZWxlY3RlZERhdGVzOnJ9PXRoaXMse3VwZGF0ZVRpbWU6aH09cyx7bW92ZVRvT3RoZXJNb250aHNPblNlbGVjdDpvLG1vdmVUb090aGVyWWVhcnNPblNlbGVjdDpsLG11bHRpcGxlRGF0ZXM6ZCxyYW5nZTpjLGF1dG9DbG9zZTp1LG9uQmVmb3JlU2VsZWN0OnB9PXRoaXMub3B0cyx2PXIubGVuZ3RoO2lmKEFycmF5LmlzQXJyYXkoZSkpcmV0dXJuIGUuZm9yRWFjaCgoZT0+e3RoaXMuc2VsZWN0RGF0ZShlLHMpfSkpLG5ldyBQcm9taXNlKChlPT57c2V0VGltZW91dChlKX0pKTtpZigoZT1iKGUpKWluc3RhbmNlb2YgRGF0ZSl7aWYocCYmIXAoe2RhdGU6ZSxkYXRlcGlja2VyOnRoaXN9KSlyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7aWYoYT09PWkuZGF5cyYmZS5nZXRNb250aCgpIT09bi5tb250aCYmbyYmKHQ9bmV3IERhdGUoZS5nZXRGdWxsWWVhcigpLGUuZ2V0TW9udGgoKSwxKSksYT09PWkueWVhcnMmJmUuZ2V0RnVsbFllYXIoKSE9PW4ueWVhciYmbCYmKHQ9bmV3IERhdGUoZS5nZXRGdWxsWWVhcigpLDAsMSkpLHQmJnRoaXMuc2V0Vmlld0RhdGUodCksZCYmIWMpe2lmKHY9PT1kKXJldHVybjt0aGlzLl9jaGVja0lmRGF0ZUlzU2VsZWN0ZWQoZSl8fHIucHVzaChlKX1lbHNlIGlmKGMpc3dpdGNoKHYpe2Nhc2UgMTpyLnB1c2goZSksdGhpcy5yYW5nZURhdGVUb3x8KHRoaXMucmFuZ2VEYXRlVG89ZSksbSh0aGlzLnJhbmdlRGF0ZUZyb20sdGhpcy5yYW5nZURhdGVUbykmJih0aGlzLnJhbmdlRGF0ZVRvPXRoaXMucmFuZ2VEYXRlRnJvbSx0aGlzLnJhbmdlRGF0ZUZyb209ZSksdGhpcy5zZWxlY3RlZERhdGVzPVt0aGlzLnJhbmdlRGF0ZUZyb20sdGhpcy5yYW5nZURhdGVUb107YnJlYWs7Y2FzZSAyOnRoaXMuc2VsZWN0ZWREYXRlcz1bZV0sdGhpcy5yYW5nZURhdGVGcm9tPWUsdGhpcy5yYW5nZURhdGVUbz1cIlwiO2JyZWFrO2RlZmF1bHQ6dGhpcy5zZWxlY3RlZERhdGVzPVtlXSx0aGlzLnJhbmdlRGF0ZUZyb209ZX1lbHNlIHRoaXMuc2VsZWN0ZWREYXRlcz1bZV07cmV0dXJuIHRoaXMudHJpZ2dlcihpLmV2ZW50Q2hhbmdlU2VsZWN0ZWREYXRlLHthY3Rpb246aS5hY3Rpb25TZWxlY3REYXRlLHNpbGVudDpudWxsPT1zP3ZvaWQgMDpzLnNpbGVudCxkYXRlOmUsdXBkYXRlVGltZTpofSksdGhpcy5fdXBkYXRlTGFzdFNlbGVjdGVkRGF0ZShlKSx1JiYhdGhpcy50aW1lcGlja2VySXNBY3RpdmUmJnRoaXMudmlzaWJsZSYmKGR8fGM/YyYmMT09PXYmJnRoaXMuaGlkZSgpOnRoaXMuaGlkZSgpKSxuZXcgUHJvbWlzZSgoZT0+e3NldFRpbWVvdXQoZSl9KSl9fXVuc2VsZWN0RGF0ZShlKXtsZXQgdD10aGlzLnNlbGVjdGVkRGF0ZXMscz10aGlzO2lmKChlPWIoZSkpaW5zdGFuY2VvZiBEYXRlKXJldHVybiB0LnNvbWUoKChhLG4pPT57aWYocChhLGUpKXJldHVybiB0LnNwbGljZShuLDEpLHMuc2VsZWN0ZWREYXRlcy5sZW5ndGg/cy5fdXBkYXRlTGFzdFNlbGVjdGVkRGF0ZShzLnNlbGVjdGVkRGF0ZXNbcy5zZWxlY3RlZERhdGVzLmxlbmd0aC0xXSk6KHMucmFuZ2VEYXRlRnJvbT1cIlwiLHMucmFuZ2VEYXRlVG89XCJcIixzLl91cGRhdGVMYXN0U2VsZWN0ZWREYXRlKCExKSksdGhpcy50cmlnZ2VyKGkuZXZlbnRDaGFuZ2VTZWxlY3RlZERhdGUse2FjdGlvbjppLmFjdGlvblVuc2VsZWN0RGF0ZSxkYXRlOmV9KSwhMH0pKX1yZXBsYWNlRGF0ZShlLHQpe2xldCBzPXRoaXMuc2VsZWN0ZWREYXRlcy5maW5kKCh0PT5wKHQsZSx0aGlzLmN1cnJlbnRWaWV3KSkpLGE9dGhpcy5zZWxlY3RlZERhdGVzLmluZGV4T2Yocyk7YTwwfHxwKHRoaXMuc2VsZWN0ZWREYXRlc1thXSx0LHRoaXMuY3VycmVudFZpZXcpfHwodGhpcy5zZWxlY3RlZERhdGVzW2FdPXQsdGhpcy50cmlnZ2VyKGkuZXZlbnRDaGFuZ2VTZWxlY3RlZERhdGUse2FjdGlvbjppLmFjdGlvblNlbGVjdERhdGUsZGF0ZTp0LHVwZGF0ZVRpbWU6ITB9KSx0aGlzLl91cGRhdGVMYXN0U2VsZWN0ZWREYXRlKHQpKX1jbGVhcigpe2xldCBlPWFyZ3VtZW50cy5sZW5ndGg+MCYmdm9pZCAwIT09YXJndW1lbnRzWzBdP2FyZ3VtZW50c1swXTp7fTtyZXR1cm4gdGhpcy5zZWxlY3RlZERhdGVzPVtdLHRoaXMucmFuZ2VEYXRlRnJvbT0hMSx0aGlzLnJhbmdlRGF0ZVRvPSExLHRoaXMubGFzdFNlbGVjdGVkRGF0ZT0hMSx0aGlzLnRyaWdnZXIoaS5ldmVudENoYW5nZVNlbGVjdGVkRGF0ZSx7YWN0aW9uOmkuYWN0aW9uVW5zZWxlY3REYXRlLHNpbGVudDplLnNpbGVudH0pLG5ldyBQcm9taXNlKChlPT57c2V0VGltZW91dChlKX0pKX1zaG93KCl7bGV0e29uU2hvdzplLGlzTW9iaWxlOnR9PXRoaXMub3B0czt0aGlzLl9jYW5jZWxTY2hlZHVsZWRDYWxsKCksdGhpcy52aXNpYmxlfHx0aGlzLmhpZGVBbmltYXRpb258fHRoaXMuX2NyZWF0ZUNvbXBvbmVudHMoKSx0aGlzLnNldFBvc2l0aW9uKHRoaXMub3B0cy5wb3NpdGlvbiksdGhpcy4kZGF0ZXBpY2tlci5jbGFzc0xpc3QuYWRkKFwiLWFjdGl2ZS1cIiksdGhpcy52aXNpYmxlPSEwLGUmJnRoaXMuX3NjaGVkdWxlQ2FsbEFmdGVyVHJhbnNpdGlvbihlKSx0JiZ0aGlzLl9zaG93TW9iaWxlT3ZlcmxheSgpfWhpZGUoKXtsZXR7b25IaWRlOmUsaXNNb2JpbGU6dH09dGhpcy5vcHRzLGk9dGhpcy5faGFzVHJhbnNpdGlvbigpO3RoaXMudmlzaWJsZT0hMSx0aGlzLmhpZGVBbmltYXRpb249ITAsdGhpcy4kZGF0ZXBpY2tlci5jbGFzc0xpc3QucmVtb3ZlKFwiLWFjdGl2ZS1cIiksdGhpcy5jdXN0b21IaWRlJiZ0aGlzLmN1c3RvbUhpZGUoKSx0aGlzLmVsSXNJbnB1dCYmdGhpcy4kZWwuYmx1cigpLHRoaXMuX3NjaGVkdWxlQ2FsbEFmdGVyVHJhbnNpdGlvbigodD0+eyF0aGlzLmN1c3RvbUhpZGUmJih0JiZpfHwhdCYmIWkpJiZ0aGlzLl9maW5pc2hIaWRlKCksZSYmZSh0KX0pKSx0JiZqLmNsYXNzTGlzdC5yZW1vdmUoXCItYWN0aXZlLVwiKX1fdHJpZ2dlck9uU2VsZWN0KCl7bGV0IGU9W10sdD1bXSx7c2VsZWN0ZWREYXRlczppLGxvY2FsZTpzLG9wdHM6e29uU2VsZWN0OmEsbXVsdGlwbGVEYXRlczpuLHJhbmdlOnJ9fT10aGlzLGg9bnx8cixvPVwiZnVuY3Rpb25cIj09dHlwZW9mIHMuZGF0ZUZvcm1hdDtpLmxlbmd0aCYmKGU9aS5tYXAoZyksdD1vP24/cy5kYXRlRm9ybWF0KGUpOmUubWFwKChlPT5zLmRhdGVGb3JtYXQoZSkpKTplLm1hcCgoZT0+dGhpcy5mb3JtYXREYXRlKGUscy5kYXRlRm9ybWF0KSkpKSxhKHtkYXRlOmg/ZTplWzBdLGZvcm1hdHRlZERhdGU6aD90OnRbMF0sZGF0ZXBpY2tlcjp0aGlzfSl9X2hhbmRsZUFscmVhZHlTZWxlY3RlZERhdGVzKGUsdCl7Y29uc3R7cmFuZ2U6aSx0b2dnbGVTZWxlY3RlZDpzfT10aGlzLm9wdHM7bGV0IGE9XCJmdW5jdGlvblwiPT10eXBlb2Ygcz9zKHtkYXRlcGlja2VyOnRoaXMsZGF0ZTp0fSk6cztpJiYoYXx8MiE9PXRoaXMuc2VsZWN0ZWREYXRlcy5sZW5ndGgmJnRoaXMuc2VsZWN0RGF0ZSh0KSksYT90aGlzLnVuc2VsZWN0RGF0ZSh0KTp0aGlzLl91cGRhdGVMYXN0U2VsZWN0ZWREYXRlKGUpfV9oYW5kbGVVcERvd25BY3Rpb25zKGUsdCl7aWYoISgoZT1iKGV8fHRoaXMuZm9jdXNEYXRlfHx0aGlzLnZpZXdEYXRlKSlpbnN0YW5jZW9mIERhdGUpKXJldHVybjtsZXQgaT1cInVwXCI9PT10P3RoaXMudmlld0luZGV4KzE6dGhpcy52aWV3SW5kZXgtMTtpPjImJihpPTIpLGk8MCYmKGk9MCksdGhpcy5zZXRWaWV3RGF0ZShuZXcgRGF0ZShlLmdldEZ1bGxZZWFyKCksZS5nZXRNb250aCgpLDEpKSx0aGlzLnNldEN1cnJlbnRWaWV3KHRoaXMudmlld0luZGV4ZXNbaV0pfV9oYW5kbGVSYW5nZU9uRm9jdXMoKXsxPT09dGhpcy5zZWxlY3RlZERhdGVzLmxlbmd0aCYmKG0odGhpcy5zZWxlY3RlZERhdGVzWzBdLHRoaXMuZm9jdXNEYXRlKT8odGhpcy5yYW5nZURhdGVUbz10aGlzLnNlbGVjdGVkRGF0ZXNbMF0sdGhpcy5yYW5nZURhdGVGcm9tPXRoaXMuZm9jdXNEYXRlKToodGhpcy5yYW5nZURhdGVUbz10aGlzLmZvY3VzRGF0ZSx0aGlzLnJhbmdlRGF0ZUZyb209dGhpcy5zZWxlY3RlZERhdGVzWzBdKSl9Z2V0Q2VsbChlKXtsZXQgdD1hcmd1bWVudHMubGVuZ3RoPjEmJnZvaWQgMCE9PWFyZ3VtZW50c1sxXT9hcmd1bWVudHNbMV06aS5kYXk7aWYoISgoZT1iKGUpKWluc3RhbmNlb2YgRGF0ZSkpcmV0dXJuO2xldHt5ZWFyOnMsbW9udGg6YSxkYXRlOm59PW8oZSkscj1gW2RhdGEteWVhcj1cIiR7c31cIl1gLGg9YFtkYXRhLW1vbnRoPVwiJHthfVwiXWAsbD17W2kuZGF5XTpgJHtyfSR7aH1bZGF0YS1kYXRlPVwiJHtufVwiXWAsW2kubW9udGhdOmAke3J9JHtofWAsW2kueWVhcl06YCR7cn1gfTtyZXR1cm4gdGhpcy52aWV3c1t0aGlzLmN1cnJlbnRWaWV3XS4kZWwucXVlcnlTZWxlY3RvcihsW3RdKX1fc2hvd01vYmlsZU92ZXJsYXkoKXtqLmNsYXNzTGlzdC5hZGQoXCItYWN0aXZlLVwiKX1faGFzVHJhbnNpdGlvbigpe3JldHVybiB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSh0aGlzLiRkYXRlcGlja2VyKS5nZXRQcm9wZXJ0eVZhbHVlKFwidHJhbnNpdGlvbi1kdXJhdGlvblwiKS5zcGxpdChcIiwgXCIpLnJlZHVjZSgoKGUsdCk9PnBhcnNlRmxvYXQodCkrZSksMCk+MH1nZXQgc2hvdWxkVXBkYXRlRE9NKCl7cmV0dXJuIHRoaXMudmlzaWJsZXx8dGhpcy50cmVhdEFzSW5saW5lfWdldCBwYXJzZWRWaWV3RGF0ZSgpe3JldHVybiBvKHRoaXMudmlld0RhdGUpfWdldCBjdXJyZW50Vmlld1Npbmd1bGFyKCl7cmV0dXJuIHRoaXMuY3VycmVudFZpZXcuc2xpY2UoMCwtMSl9Z2V0IGN1ckRlY2FkZSgpe3JldHVybiBjKHRoaXMudmlld0RhdGUpfWdldCB2aWV3SW5kZXgoKXtyZXR1cm4gdGhpcy52aWV3SW5kZXhlcy5pbmRleE9mKHRoaXMuY3VycmVudFZpZXcpfWdldCBpc0ZpbmFsVmlldygpe3JldHVybiB0aGlzLmN1cnJlbnRWaWV3PT09aS55ZWFyc31nZXQgaGFzU2VsZWN0ZWREYXRlcygpe3JldHVybiB0aGlzLnNlbGVjdGVkRGF0ZXMubGVuZ3RoPjB9Z2V0IGlzTWluVmlld1JlYWNoZWQoKXtyZXR1cm4gdGhpcy5jdXJyZW50Vmlldz09PXRoaXMub3B0cy5taW5WaWV3fHx0aGlzLmN1cnJlbnRWaWV3PT09aS5kYXlzfWdldCAkY29udGFpbmVyKCl7cmV0dXJuIHRoaXMuJGN1c3RvbUNvbnRhaW5lcnx8UH1zdGF0aWMgcmVwbGFjZXIoZSx0LGkpe3JldHVybiBlLnJlcGxhY2UodCwoZnVuY3Rpb24oZSx0LHMsYSl7cmV0dXJuIHQraSthfSkpfX12YXIgSztyZXR1cm4gSShCLFwiZGVmYXVsdHNcIixzKSxJKEIsXCJ2ZXJzaW9uXCIsXCIzLjQuMFwiKSxJKEIsXCJkZWZhdWx0R2xvYmFsQ29udGFpbmVySWRcIixcImFpci1kYXRlcGlja2VyLWdsb2JhbC1jb250YWluZXJcIiksSz1CLnByb3RvdHlwZSxPYmplY3QuYXNzaWduKEssTiksdC5kZWZhdWx0fSgpfSkpOyJdLCJmaWxlIjoiYWlyLWRhdGVwaWNrZXIuanMifQ==
